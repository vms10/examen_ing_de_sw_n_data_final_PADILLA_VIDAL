import{u as g,r as p,a as m,j as e,B as c,F as l,S as u,T as h,b as x,C as f,L as j,c as w,g as L,d as v,e as b,f as y,H as C,h as S}from"./index-C3zHQ3xU.js";const T=({taskInstance:s,wrap:t})=>{const{t:a}=g("dag"),[o,d]=p.useState(!1),{error:r,isLoading:i,parsedData:n}=m({dagId:s.dag_id,limit:100,logLevelFilters:["error","critical"],taskInstance:s,tryNumber:s.try_number},{enabled:o,refetchInterval:!1,retry:!1});return e.jsxs(c,{borderRadius:4,borderStyle:"solid",borderWidth:1,width:"100%",children:[e.jsxs(l,{alignItems:"center",justifyContent:"space-between",px:2,py:2,children:[e.jsxs(c,{children:[e.jsx(u,{mr:1,state:s.state}),s.task_display_name,e.jsx(h,{datetime:s.run_after,ml:1})]}),e.jsxs(l,{gap:1,children:[e.jsx(x,{fontSize:"sm",onClick:()=>d(!o),size:"sm",variant:"ghost",children:a(o?"overview.failedLogs.hideLogs":"overview.failedLogs.showLogs")}),e.jsx(f,{taskInstance:s,withText:!1}),e.jsx(j,{asChild:!0,color:"fg.info",fontSize:"sm",children:e.jsx(w,{to:L(s),children:a("overview.failedLogs.viewFullLogs")})})]})]}),o?e.jsx(c,{borderTopStyle:"solid",borderTopWidth:1,maxHeight:"200px",overflow:"auto",children:e.jsx(v,{error:r,isLoading:i,logError:r,parsedLogs:n.parsedLogs??[],wrap:t})}):null]},s.id)},z=({failedTasks:s})=>{const{t}=g(["dag","common"]),a=!!b("default_wrap"),[o,d]=p.useState(a),r=s==null?void 0:s.task_instances.slice(0,5),i=()=>d(!o);if(y("w",i),!(r===void 0||r.length<=0))return e.jsxs(l,{flexDirection:"column",gap:3,children:[e.jsxs(l,{alignItems:"center",justifyContent:"space-between",children:[e.jsx(C,{size:"md",children:t("overview.failedLogs.title")}),e.jsx(S,{closeDelay:100,content:t("common:wrap.tooltip",{hotkey:"w"}),openDelay:100,children:e.jsx(x,{"aria-label":t(`common:wrap.${o?"un":""}wrap`),bg:"bg.panel",fontSize:"sm",onClick:i,size:"sm",variant:"outline",children:t(`common:wrap.${o?"un":""}wrap`)})})]}),r.map(n=>e.jsx(T,{taskInstance:n,wrap:o},n.id))]})};export{z as default};
