[0m15:26:49.508191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a973af44140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a97390dff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a97394e5640>]}


============================== 15:26:49.513098 | b563bc09-ab36-43ec-be1e-d317e0b724bb ==============================
[0m15:26:49.513098 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:26:49.513600 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'version_check': 'True', 'invocation_command': 'dbt run --project-dir /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:26:49.953528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9739494650>]}
[0m15:26:50.006592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972ea0f410>]}
[0m15:26:50.009397 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:26:50.107459 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:26:50.108324 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:26:50.108898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972e91cda0>]}
[0m15:26:51.390567 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:26:51.391083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972cfd7ec0>]}
[0m15:26:51.484234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972ce2cb60>]}
[0m15:26:51.546860 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:26:51.550278 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:26:51.584846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972cec3fe0>]}
[0m15:26:51.585284 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:26:51.585617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972ce1bd70>]}
[0m15:26:51.587167 [info ] [MainThread]: 
[0m15:26:51.587606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:26:51.587889 [info ] [MainThread]: 
[0m15:26:51.588332 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:26:51.592449 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:26:51.641936 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:26:51.642442 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:26:51.642744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:53.773338 [debug] [ThreadPool]: SQL status: OK in 2.130 seconds
[0m15:26:53.774735 [debug] [ThreadPool]: On list_medallion: Close
[0m15:26:53.775654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:26:53.776238 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:26:53.781670 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:26:53.782045 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:26:53.782342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:53.783667 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:53.785039 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:26:53.785430 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:26:53.786209 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:53.786605 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:26:53.786839 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:26:53.787671 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:53.788482 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:26:53.788772 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:26:53.788995 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:26:53.790016 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:53.790517 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:26:53.792485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:26:53.797570 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:26:53.797937 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:26:53.798197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:53.799388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:53.799857 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:26:53.800169 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:26:53.815506 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:26:53.816771 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:26:53.818953 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:26:53.819358 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:26:53.820320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9734327aa0>]}
[0m15:26:53.820938 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:53.821395 [debug] [MainThread]: On master: BEGIN
[0m15:26:53.821672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:53.822659 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:53.823059 [debug] [MainThread]: On master: COMMIT
[0m15:26:53.823308 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:53.823528 [debug] [MainThread]: On master: COMMIT
[0m15:26:53.824563 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:53.825312 [debug] [MainThread]: On master: Close
[0m15:26:53.832450 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:26:53.833057 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:26:53.833571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:26:53.834036 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:26:53.842426 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:26:53.845920 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:26:53.881547 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:26:53.885287 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:26:53.885863 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:26:53.886175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:53.887817 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:26:53.888439 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:26:53.889038 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:26:53.899986 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:26:53.900698 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:26:53.901232 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m15:26:53.913659 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m15:26:53.914181 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:26:53.916295 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:26:53.918721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b563bc09-ab36-43ec-be1e-d317e0b724bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972ce469c0>]}
[0m15:26:53.919579 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.08s]
[0m15:26:53.920156 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:26:53.920984 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m15:26:53.922998 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:26:53.923517 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m15:26:53.924396 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:26:53.927228 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:53.927653 [debug] [MainThread]: On master: BEGIN
[0m15:26:53.927942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:53.929078 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:53.929488 [debug] [MainThread]: On master: COMMIT
[0m15:26:53.929784 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:53.930181 [debug] [MainThread]: On master: COMMIT
[0m15:26:53.931096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:53.931565 [debug] [MainThread]: On master: Close
[0m15:26:53.931989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:53.932398 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:26:53.932745 [info ] [MainThread]: 
[0m15:26:53.933239 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m15:26:53.934293 [debug] [MainThread]: Command end result
[0m15:26:53.954920 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:26:53.956920 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:26:53.962793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m15:26:53.963253 [info ] [MainThread]: 
[0m15:26:53.964102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:26:53.964985 [info ] [MainThread]: 
[0m15:26:53.966007 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m15:26:53.967075 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:26:53.967717 [info ] [MainThread]: 
[0m15:26:53.968208 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m15:26:53.968609 [info ] [MainThread]: 
[0m15:26:53.969018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m15:26:53.969578 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:26:53.971720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.516286, "process_in_blocks": "135976", "process_kernel_time": 1.112552, "process_mem_max_rss": "204660", "process_out_blocks": "45024", "process_user_time": 3.741406}
[0m15:26:53.972307 [debug] [MainThread]: Command `dbt run` failed at 15:26:53.972177 after 4.52 seconds
[0m15:26:53.972785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a973859f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972c143920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a972cf32450>]}
[0m15:26:53.973259 [debug] [MainThread]: Flushing usage events
[0m15:26:54.644422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:38.817515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee34d6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee4e854f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee237c200>]}


============================== 15:30:38.821325 | a4892a17-eaf2-49f8-9e27-237057f452f0 ==============================
[0m15:30:38.821325 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:30:38.821812 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m15:30:39.078912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee220dc70>]}
[0m15:30:39.139846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee220fef0>]}
[0m15:30:39.142430 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:30:39.237848 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:30:39.343861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:39.344307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:39.380929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aed84fc8c0>]}
[0m15:30:39.445279 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:30:39.446924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:30:39.461449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aed8280d70>]}
[0m15:30:39.461985 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:30:39.462380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aed82fd580>]}
[0m15:30:39.464071 [info ] [MainThread]: 
[0m15:30:39.464589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:39.464875 [info ] [MainThread]: 
[0m15:30:39.465339 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:30:39.469691 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:30:39.513469 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:30:39.513928 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:30:39.514209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:39.533750 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:30:39.535110 [debug] [ThreadPool]: On list_medallion: Close
[0m15:30:39.536333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:30:39.537291 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:30:39.545706 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:30:39.546093 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:30:39.546357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:39.547666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:39.548970 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:30:39.549296 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:30:39.550505 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:39.551485 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:30:39.552132 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:30:39.553235 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:39.554307 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:30:39.554953 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:30:39.555216 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:30:39.555988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:30:39.556410 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:30:39.558256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:30:39.562992 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:30:39.563434 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:30:39.563663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:39.565010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:39.565589 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:30:39.565821 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:30:39.577849 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:30:39.579070 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:30:39.580131 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:30:39.580509 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:30:39.581417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee2249dc0>]}
[0m15:30:39.581869 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:39.582110 [debug] [MainThread]: On master: BEGIN
[0m15:30:39.582317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:39.583218 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:39.583582 [debug] [MainThread]: On master: COMMIT
[0m15:30:39.583814 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:39.584064 [debug] [MainThread]: On master: COMMIT
[0m15:30:39.585049 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:39.585657 [debug] [MainThread]: On master: Close
[0m15:30:39.590406 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:30:39.591074 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:30:39.591571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:30:39.591876 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:30:39.600076 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:30:39.601088 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:30:39.629370 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:30:39.630289 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:30:39.630679 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:30:39.630962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:39.632401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:30:39.632924 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:30:39.633304 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:30:39.634654 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:30:39.635092 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:30:39.635474 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m15:30:39.639401 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m15:30:39.639786 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:30:39.641695 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:30:39.643071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4892a17-eaf2-49f8-9e27-237057f452f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee31fe1e0>]}
[0m15:30:39.643685 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.05s]
[0m15:30:39.644354 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:30:39.645190 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m15:30:39.648316 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:30:39.649072 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m15:30:39.649584 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:30:39.652998 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:39.653412 [debug] [MainThread]: On master: BEGIN
[0m15:30:39.653652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:39.655043 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:39.655459 [debug] [MainThread]: On master: COMMIT
[0m15:30:39.655691 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:39.655914 [debug] [MainThread]: On master: COMMIT
[0m15:30:39.657240 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:39.657921 [debug] [MainThread]: On master: Close
[0m15:30:39.658329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:39.658557 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:30:39.658798 [info ] [MainThread]: 
[0m15:30:39.659133 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m15:30:39.659702 [debug] [MainThread]: Command end result
[0m15:30:39.679758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:30:39.682047 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:30:39.686993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m15:30:39.687409 [info ] [MainThread]: 
[0m15:30:39.687825 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:39.688246 [info ] [MainThread]: 
[0m15:30:39.688719 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m15:30:39.689111 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:30:39.689404 [info ] [MainThread]: 
[0m15:30:39.689722 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m15:30:39.689997 [info ] [MainThread]: 
[0m15:30:39.690310 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m15:30:39.691299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9279084, "process_in_blocks": "0", "process_kernel_time": 0.553612, "process_mem_max_rss": "152076", "process_out_blocks": "2176", "process_user_time": 2.247258}
[0m15:30:39.691739 [debug] [MainThread]: Command `dbt run` failed at 15:30:39.691659 after 0.93 seconds
[0m15:30:39.692065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aed21c0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aee237c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aed20bf920>]}
[0m15:30:39.692490 [debug] [MainThread]: Flushing usage events
[0m15:30:40.323453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:38.677331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493a256f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493a25cc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493a28c6210>]}


============================== 15:33:38.680864 | 45a376fa-74fe-436c-8098-f2e463a28292 ==============================
[0m15:33:38.680864 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:33:38.681507 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --project-dir /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'use_colors': 'True', 'log_path': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'no_print': 'None'}
[0m15:33:38.920693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493979fb9b0>]}
[0m15:33:38.981238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749397b3acf0>]}
[0m15:33:38.983060 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:33:39.075749 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:33:39.183341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:39.183743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:39.219214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749397acd5e0>]}
[0m15:33:39.286149 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:33:39.287902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:33:39.301379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749397664c20>]}
[0m15:33:39.301918 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:33:39.302339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493979f9eb0>]}
[0m15:33:39.304003 [info ] [MainThread]: 
[0m15:33:39.304420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:39.304694 [info ] [MainThread]: 
[0m15:33:39.305133 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:33:39.311193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:33:39.351297 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:33:39.351697 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:33:39.351930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:39.371002 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:33:39.373703 [debug] [ThreadPool]: On list_medallion: Close
[0m15:33:39.374890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:33:39.375441 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:33:39.382440 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:33:39.382835 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:33:39.383235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:39.384571 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:39.385820 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:33:39.386129 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:33:39.387654 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:39.388108 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:33:39.388627 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:33:39.389814 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:39.390807 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:33:39.391169 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:33:39.391437 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:33:39.392140 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:33:39.392440 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:33:39.394634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:33:39.399725 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:33:39.400108 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:33:39.400327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:39.401508 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:33:39.401932 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:33:39.402262 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:33:39.416262 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:33:39.417617 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:33:39.419151 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:33:39.419835 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:33:39.421044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74939761bb30>]}
[0m15:33:39.421616 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:39.421876 [debug] [MainThread]: On master: BEGIN
[0m15:33:39.422101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:39.422988 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:39.423324 [debug] [MainThread]: On master: COMMIT
[0m15:33:39.423595 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:39.423810 [debug] [MainThread]: On master: COMMIT
[0m15:33:39.424724 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:39.425115 [debug] [MainThread]: On master: Close
[0m15:33:39.430538 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:33:39.431126 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:33:39.431653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:33:39.431950 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:33:39.440935 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:33:39.441629 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:33:39.471896 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:33:39.472697 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:33:39.473107 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:33:39.473410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:39.474589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:33:39.475043 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:33:39.475314 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:33:39.476327 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:33:39.476672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:33:39.477047 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m15:33:39.480813 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m15:33:39.481240 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:33:39.483843 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:33:39.485628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a376fa-74fe-436c-8098-f2e463a28292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493954c0320>]}
[0m15:33:39.486377 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.05s]
[0m15:33:39.486975 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:33:39.487595 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m15:33:39.489105 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:33:39.490316 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m15:33:39.490968 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:33:39.493383 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:39.493776 [debug] [MainThread]: On master: BEGIN
[0m15:33:39.494033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:39.495180 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:39.495693 [debug] [MainThread]: On master: COMMIT
[0m15:33:39.496261 [debug] [MainThread]: Using duckdb connection "master"
[0m15:33:39.496626 [debug] [MainThread]: On master: COMMIT
[0m15:33:39.497468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:33:39.497843 [debug] [MainThread]: On master: Close
[0m15:33:39.498763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:39.499545 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:33:39.500253 [info ] [MainThread]: 
[0m15:33:39.500839 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:33:39.501606 [debug] [MainThread]: Command end result
[0m15:33:39.522803 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:33:39.524856 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:33:39.530006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m15:33:39.530791 [info ] [MainThread]: 
[0m15:33:39.531534 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:39.532033 [info ] [MainThread]: 
[0m15:33:39.532516 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m15:33:39.532873 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:33:39.533150 [info ] [MainThread]: 
[0m15:33:39.533457 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m15:33:39.533730 [info ] [MainThread]: 
[0m15:33:39.534034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m15:33:39.534984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9169993, "process_in_blocks": "0", "process_kernel_time": 0.579559, "process_mem_max_rss": "152532", "process_out_blocks": "2176", "process_user_time": 2.476677}
[0m15:33:39.535391 [debug] [MainThread]: Command `dbt run` failed at 15:33:39.535319 after 0.92 seconds
[0m15:33:39.535685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493a3bee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749397accce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7493a28600e0>]}
[0m15:33:39.535959 [debug] [MainThread]: Flushing usage events
[0m15:33:40.296614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:15.578888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d95251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d71fc8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d71ffbf0>]}


============================== 15:55:15.583195 | 179dab33-708f-40cb-9025-b9df5c7d0076 ==============================
[0m15:55:15.583195 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:55:15.583704 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run --project-dir /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'send_anonymous_usage_stats': 'True'}
[0m15:55:15.870838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d683f6b0>]}
[0m15:55:15.947161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d6d44920>]}
[0m15:55:15.949391 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:55:16.059635 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:55:16.204290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:16.205279 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m15:55:17.756395 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:55:17.757030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9cc899d90>]}
[0m15:55:17.818652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e99efcecc0>]}
[0m15:55:17.892618 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:55:17.895082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:55:17.984103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9cc78b3e0>]}
[0m15:55:17.984670 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:55:17.985021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e99ee47320>]}
[0m15:55:17.987679 [info ] [MainThread]: 
[0m15:55:17.988378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:17.988814 [info ] [MainThread]: 
[0m15:55:17.989517 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:55:17.994907 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:55:18.032637 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:55:18.033055 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:55:18.033356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:18.055108 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:55:18.056767 [debug] [ThreadPool]: On list_medallion: Close
[0m15:55:18.058246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:55:18.058993 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:55:18.065126 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:55:18.065566 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:55:18.065821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:18.067173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:55:18.068610 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:55:18.068980 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:55:18.070022 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:55:18.070532 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:55:18.071038 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:55:18.072630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:55:18.073724 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:55:18.074360 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:55:18.074688 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:55:18.075783 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:55:18.076225 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:55:18.078116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:55:18.085376 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:55:18.085763 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:55:18.086067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:18.088737 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:55:18.089383 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:55:18.090224 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:55:18.103038 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:55:18.105104 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:55:18.106650 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:55:18.107172 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:55:18.108263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d915c290>]}
[0m15:55:18.108894 [debug] [MainThread]: Using duckdb connection "master"
[0m15:55:18.109194 [debug] [MainThread]: On master: BEGIN
[0m15:55:18.109424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:18.110626 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:55:18.111313 [debug] [MainThread]: On master: COMMIT
[0m15:55:18.111580 [debug] [MainThread]: Using duckdb connection "master"
[0m15:55:18.111808 [debug] [MainThread]: On master: COMMIT
[0m15:55:18.112896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:55:18.113266 [debug] [MainThread]: On master: Close
[0m15:55:18.118907 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:55:18.119735 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:55:18.121055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:55:18.121674 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:55:18.131122 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:55:18.131846 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:55:18.162274 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:55:18.163040 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:55:18.163395 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:55:18.163730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:18.165243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:55:18.166000 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:55:18.166310 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source;
  );

[0m15:55:18.167479 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source;
  );

[0m15:55:18.167851 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:55:18.168260 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m15:55:18.172741 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m15:55:18.173270 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:55:18.175461 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 23: from source;
                      ^
[0m15:55:18.177116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '179dab33-708f-40cb-9025-b9df5c7d0076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9cc795c40>]}
[0m15:55:18.177790 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.06s]
[0m15:55:18.178447 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:55:18.179306 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 23: from source;
                      ^.
[0m15:55:18.182067 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:55:18.182722 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m15:55:18.183131 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:55:18.186630 [debug] [MainThread]: Using duckdb connection "master"
[0m15:55:18.187048 [debug] [MainThread]: On master: BEGIN
[0m15:55:18.187337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:18.188387 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:55:18.188882 [debug] [MainThread]: On master: COMMIT
[0m15:55:18.189262 [debug] [MainThread]: Using duckdb connection "master"
[0m15:55:18.189591 [debug] [MainThread]: On master: COMMIT
[0m15:55:18.190900 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:55:18.191389 [debug] [MainThread]: On master: Close
[0m15:55:18.191972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:18.192361 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:55:18.192826 [info ] [MainThread]: 
[0m15:55:18.193227 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:55:18.193995 [debug] [MainThread]: Command end result
[0m15:55:18.215704 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:55:18.217540 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:55:18.223595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m15:55:18.224103 [info ] [MainThread]: 
[0m15:55:18.224521 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:55:18.224859 [info ] [MainThread]: 
[0m15:55:18.225262 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m15:55:18.225673 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 23: from source;
                      ^
[0m15:55:18.226032 [info ] [MainThread]: 
[0m15:55:18.226389 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m15:55:18.226699 [info ] [MainThread]: 
[0m15:55:18.227041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m15:55:18.227531 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:55:18.228483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.618649, "process_in_blocks": "0", "process_kernel_time": 0.568615, "process_mem_max_rss": "155044", "process_out_blocks": "3200", "process_user_time": 2.790277}
[0m15:55:18.228895 [debug] [MainThread]: Command `dbt run` failed at 15:55:18.228820 after 1.62 seconds
[0m15:55:18.229257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d684f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e9d7719370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e99ef34e60>]}
[0m15:55:18.229550 [debug] [MainThread]: Flushing usage events
[0m15:55:19.160943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:04.944661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa14465f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa15b861e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa15b866f0>]}


============================== 15:57:04.948810 | 06a854c3-c5ec-44ff-9071-7fb3f6591640 ==============================
[0m15:57:04.948810 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:57:04.949406 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --project-dir /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt'}
[0m15:57:05.152447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa1424c740>]}
[0m15:57:05.203442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa1383ca10>]}
[0m15:57:05.205143 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:57:05.289126 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:57:05.378159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:05.378768 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m15:57:05.710496 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:57:05.711255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9dba72840>]}
[0m15:57:05.765303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9dbad1100>]}
[0m15:57:05.823847 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:57:05.825691 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:57:05.905702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9dbb55cd0>]}
[0m15:57:05.906176 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:57:05.906524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa14291ee0>]}
[0m15:57:05.908519 [info ] [MainThread]: 
[0m15:57:05.909096 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:05.909411 [info ] [MainThread]: 
[0m15:57:05.909891 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:57:05.914635 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:57:05.947568 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:57:05.947950 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:57:05.948244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:05.964851 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:57:05.966121 [debug] [ThreadPool]: On list_medallion: Close
[0m15:57:05.967104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:57:05.967520 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:57:05.974130 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:57:05.974522 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:57:05.974739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:05.976029 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:05.977493 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:57:05.977895 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:57:05.978822 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:05.979177 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:57:05.979399 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:57:05.980525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:05.981541 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:57:05.981908 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:57:05.982144 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:57:05.983192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:05.983794 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:57:05.986107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:57:05.997438 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:57:05.998398 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:57:05.999648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:06.001589 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:57:06.002464 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:57:06.003655 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:57:06.017487 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:57:06.018761 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:57:06.020013 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:57:06.020420 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:57:06.021597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa0933b470>]}
[0m15:57:06.022302 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:06.022751 [debug] [MainThread]: On master: BEGIN
[0m15:57:06.023092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:06.024266 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:57:06.024659 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.025102 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:06.025415 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.026585 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:57:06.027250 [debug] [MainThread]: On master: Close
[0m15:57:06.032831 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:57:06.033897 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:57:06.034625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:57:06.035038 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:57:06.043499 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:57:06.044134 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:57:06.070139 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:57:06.071330 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:57:06.073965 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:57:06.076328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:06.078255 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:57:06.079102 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:57:06.079858 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m15:57:06.086388 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:57:06.093263 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:57:06.093782 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m15:57:06.095263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:06.106647 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m15:57:06.107185 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:57:06.107581 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m15:57:06.113374 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:57:06.118667 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:57:06.119374 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m15:57:06.120425 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:06.122871 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:57:06.124358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9dbbc1160>]}
[0m15:57:06.125071 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.09s]
[0m15:57:06.125806 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:57:06.126961 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:57:06.128069 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m15:57:06.129237 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m15:57:06.129813 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m15:57:06.134611 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m15:57:06.137271 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m15:57:06.164305 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m15:57:06.166280 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m15:57:06.166909 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m15:57:06.167305 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:06.169425 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:06.170372 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m15:57:06.170959 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m15:57:06.172152 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m15:57:06.172721 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m15:57:06.173371 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m15:57:06.178454 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m15:57:06.179320 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m15:57:06.182745 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m15:57:06.183988 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06a854c3-c5ec-44ff-9071-7fb3f6591640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea9dafbbf80>]}
[0m15:57:06.185618 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.05s]
[0m15:57:06.186618 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:57:06.187532 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^.
[0m15:57:06.191136 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:06.191874 [debug] [MainThread]: On master: BEGIN
[0m15:57:06.192530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:06.194596 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:57:06.195082 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.195402 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:06.195645 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.196659 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:57:06.197146 [debug] [MainThread]: On master: Close
[0m15:57:06.197619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:06.197953 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:57:06.198295 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m15:57:06.198842 [info ] [MainThread]: 
[0m15:57:06.199342 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:57:06.200302 [debug] [MainThread]: Command end result
[0m15:57:06.221169 [debug] [MainThread]: Wrote artifact WritableManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m15:57:06.223071 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m15:57:06.228586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/msol/examen_vidal_padilla/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m15:57:06.229523 [info ] [MainThread]: 
[0m15:57:06.230033 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:06.230696 [info ] [MainThread]: 
[0m15:57:06.231486 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m15:57:06.231998 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m15:57:06.232322 [info ] [MainThread]: 
[0m15:57:06.232748 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m15:57:06.233182 [info ] [MainThread]: 
[0m15:57:06.233531 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m15:57:06.233999 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:57:06.234937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3399309, "process_in_blocks": "608", "process_kernel_time": 0.47056, "process_mem_max_rss": "156744", "process_out_blocks": "3248", "process_user_time": 2.571276}
[0m15:57:06.235450 [debug] [MainThread]: Command `dbt run` failed at 15:57:06.235349 after 1.34 seconds
[0m15:57:06.235791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa1427ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa1433f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaa1433f3b0>]}
[0m15:57:06.236080 [debug] [MainThread]: Flushing usage events
[0m15:57:06.981126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:58.604287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8bb2fcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ba75f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8baf8fe30>]}


============================== 10:49:58.611762 | 5ea8b098-67b3-4cbd-9b08-6eabf4914d0b ==============================
[0m10:49:58.611762 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:49:58.612722 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m10:49:59.158829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ba0461e0>]}
[0m10:49:59.266460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8b5d7bda0>]}
[0m10:49:59.275545 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:49:59.463797 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m10:49:59.620076 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:49:59.621443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ba9cfb90>]}
[0m10:50:01.375708 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m10:50:01.377355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ba0782f0>]}
[0m10:50:01.547528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ac147800>]}
[0m10:50:01.671511 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:50:01.682496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:50:01.729848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8b5d78740>]}
[0m10:50:01.731082 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m10:50:01.731731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ac1ea420>]}
[0m10:50:01.734414 [info ] [MainThread]: 
[0m10:50:01.735063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:01.735586 [info ] [MainThread]: 
[0m10:50:01.736799 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:50:01.743915 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m10:50:01.813764 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m10:50:01.814861 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m10:50:01.815351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:03.224404 [debug] [ThreadPool]: SQL status: OK in 1.409 seconds
[0m10:50:03.226620 [debug] [ThreadPool]: On list_medallion: Close
[0m10:50:03.227924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m10:50:03.228602 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m10:50:03.237715 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:50:03.238670 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m10:50:03.239137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:03.241652 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:50:03.243955 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:50:03.244472 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m10:50:03.246284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:03.246939 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:50:03.247531 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m10:50:03.249308 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:03.251915 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:50:03.252784 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:50:03.253417 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:50:03.255076 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:03.255628 [debug] [ThreadPool]: On create_medallion_main: Close
[0m10:50:03.257601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m10:50:03.264845 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:50:03.265460 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m10:50:03.266104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:03.267536 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:50:03.267984 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:50:03.268424 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m10:50:03.286993 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:50:03.289037 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m10:50:03.291665 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m10:50:03.292178 [debug] [ThreadPool]: On list_medallion_main: Close
[0m10:50:03.293965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8b5d4ade0>]}
[0m10:50:03.294718 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:03.295171 [debug] [MainThread]: On master: BEGIN
[0m10:50:03.295638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:03.296745 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:03.297184 [debug] [MainThread]: On master: COMMIT
[0m10:50:03.297610 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:03.298172 [debug] [MainThread]: On master: COMMIT
[0m10:50:03.299352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:03.299872 [debug] [MainThread]: On master: Close
[0m10:50:03.310692 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m10:50:03.311598 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m10:50:03.312360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m10:50:03.312886 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m10:50:03.324814 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m10:50:03.325791 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m10:50:03.364310 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m10:50:03.365458 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.366194 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m10:50:03.366813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:03.368510 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:50:03.369016 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.369537 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m10:50:03.374534 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m10:50:03.383503 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.384198 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m10:50:03.385575 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:50:03.388934 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.389495 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m10:50:03.390613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:50:03.405286 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:50:03.405918 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.406487 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:50:03.412860 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:50:03.420156 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:50:03.420819 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m10:50:03.426260 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m10:50:03.429248 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m10:50:03.432032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ac1f59d0>]}
[0m10:50:03.432980 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.12s]
[0m10:50:03.434000 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m10:50:03.435956 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m10:50:03.437051 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m10:50:03.437884 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m10:50:03.438417 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m10:50:03.442093 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m10:50:03.443223 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m10:50:03.467542 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m10:50:03.468768 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:50:03.469429 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m10:50:03.469961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:50:03.471572 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:50:03.472088 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:50:03.472586 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:50:03.487364 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:50:03.488226 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:50:03.488957 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m10:50:03.501726 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m10:50:03.502396 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m10:50:03.505289 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:50:03.506077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea8b098-67b3-4cbd-9b08-6eabf4914d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8840b8e60>]}
[0m10:50:03.506986 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.07s]
[0m10:50:03.508556 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m10:50:03.509701 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^.
[0m10:50:03.514180 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:03.514681 [debug] [MainThread]: On master: BEGIN
[0m10:50:03.515148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:03.516636 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:03.517160 [debug] [MainThread]: On master: COMMIT
[0m10:50:03.517597 [debug] [MainThread]: Using duckdb connection "master"
[0m10:50:03.518155 [debug] [MainThread]: On master: COMMIT
[0m10:50:03.519159 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:50:03.519630 [debug] [MainThread]: On master: Close
[0m10:50:03.520323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:03.520874 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m10:50:03.521528 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m10:50:03.522108 [info ] [MainThread]: 
[0m10:50:03.522699 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m10:50:03.523849 [debug] [MainThread]: Command end result
[0m10:50:03.557120 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:50:03.559883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:50:03.568165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m10:50:03.568708 [info ] [MainThread]: 
[0m10:50:03.569362 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:50:03.570229 [info ] [MainThread]: 
[0m10:50:03.570872 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m10:50:03.571458 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:50:03.572037 [info ] [MainThread]: 
[0m10:50:03.572654 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m10:50:03.573154 [info ] [MainThread]: 
[0m10:50:03.573703 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:50:03.574546 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:50:03.576121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0726323, "process_in_blocks": "108864", "process_kernel_time": 1.323057, "process_mem_max_rss": "199332", "process_out_blocks": "44920", "process_user_time": 6.108744}
[0m10:50:03.576806 [debug] [MainThread]: Command `dbt run` failed at 10:50:03.576660 after 5.07 seconds
[0m10:50:03.577380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8bac74560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8bbbae510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc8ae4ec170>]}
[0m10:50:03.577956 [debug] [MainThread]: Flushing usage events
[0m10:50:04.620954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:53.353063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c1319aeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c13299ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c133dca1b0>]}


============================== 10:52:53.359600 | 82f4c110-2fc6-4967-9488-576734e46db8 ==============================
[0m10:52:53.359600 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:52:53.360468 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m10:52:53.707588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c1343a4e60>]}
[0m10:52:53.805442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c12d7a89b0>]}
[0m10:52:53.807949 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:52:53.964606 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m10:52:54.106741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:54.107528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:54.158378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c125d3ef60>]}
[0m10:52:54.257851 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:52:54.260508 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:52:54.279869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c0f3b81460>]}
[0m10:52:54.280678 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m10:52:54.281335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c125ec3d70>]}
[0m10:52:54.283883 [info ] [MainThread]: 
[0m10:52:54.284514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:52:54.285086 [info ] [MainThread]: 
[0m10:52:54.285953 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:52:54.294543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m10:52:54.359803 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m10:52:54.360805 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m10:52:54.361605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:54.389739 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m10:52:54.391952 [debug] [ThreadPool]: On list_medallion: Close
[0m10:52:54.393435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m10:52:54.394616 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m10:52:54.404738 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:52:54.405537 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m10:52:54.406151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:54.408496 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:52:54.410427 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:52:54.410917 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m10:52:54.412180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:54.412614 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:52:54.413019 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m10:52:54.414180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:54.415417 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:52:54.416133 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:52:54.416989 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:52:54.418734 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:54.419276 [debug] [ThreadPool]: On create_medallion_main: Close
[0m10:52:54.421518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m10:52:54.428948 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:52:54.429546 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m10:52:54.430063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:54.431914 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:52:54.432486 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:52:54.433261 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m10:52:54.449880 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:52:54.451966 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m10:52:54.454185 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m10:52:54.455029 [debug] [ThreadPool]: On list_medallion_main: Close
[0m10:52:54.456795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c125e81ac0>]}
[0m10:52:54.457585 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:54.458082 [debug] [MainThread]: On master: BEGIN
[0m10:52:54.458525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:54.460137 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:52:54.460800 [debug] [MainThread]: On master: COMMIT
[0m10:52:54.461364 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:54.461847 [debug] [MainThread]: On master: COMMIT
[0m10:52:54.462879 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:52:54.463357 [debug] [MainThread]: On master: Close
[0m10:52:54.469222 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m10:52:54.470073 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m10:52:54.470994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m10:52:54.471716 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m10:52:54.484985 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m10:52:54.486852 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m10:52:54.531149 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m10:52:54.532409 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.533021 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m10:52:54.533571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:54.535409 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:52:54.535972 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.536522 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m10:52:54.538974 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:52:54.551216 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.552014 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m10:52:54.553906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:54.557400 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.558124 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m10:52:54.559605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:52:54.575886 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:52:54.577087 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.577740 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:52:54.585278 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:52:54.593240 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:52:54.594074 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m10:52:54.600964 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m10:52:54.606458 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m10:52:54.609094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c0f2fb0290>]}
[0m10:52:54.610200 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.14s]
[0m10:52:54.611247 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m10:52:54.613476 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m10:52:54.615343 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m10:52:54.616474 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m10:52:54.617454 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m10:52:54.623015 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m10:52:54.624310 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m10:52:54.658284 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m10:52:54.659699 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:52:54.660417 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m10:52:54.661064 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:52:54.663070 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:52:54.663912 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:52:54.664847 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:52:54.666456 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:52:54.667329 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:52:54.668343 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m10:52:54.675329 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m10:52:54.676169 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m10:52:54.679478 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:52:54.680324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f4c110-2fc6-4967-9488-576734e46db8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c0f2fed490>]}
[0m10:52:54.681485 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.06s]
[0m10:52:54.682747 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m10:52:54.683760 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^.
[0m10:52:54.689413 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:54.690266 [debug] [MainThread]: On master: BEGIN
[0m10:52:54.690910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:54.693235 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:52:54.693908 [debug] [MainThread]: On master: COMMIT
[0m10:52:54.694394 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:54.694954 [debug] [MainThread]: On master: COMMIT
[0m10:52:54.696423 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:52:54.697122 [debug] [MainThread]: On master: Close
[0m10:52:54.697883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:54.698333 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m10:52:54.698868 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m10:52:54.699368 [info ] [MainThread]: 
[0m10:52:54.700079 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m10:52:54.701542 [debug] [MainThread]: Command end result
[0m10:52:54.740416 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:52:54.743212 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:52:54.753244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m10:52:54.753929 [info ] [MainThread]: 
[0m10:52:54.754727 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:52:54.755504 [info ] [MainThread]: 
[0m10:52:54.756408 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m10:52:54.757201 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:52:54.757827 [info ] [MainThread]: 
[0m10:52:54.758417 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m10:52:54.758935 [info ] [MainThread]: 
[0m10:52:54.759622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:52:54.761266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4899611, "process_in_blocks": "0", "process_kernel_time": 0.666801, "process_mem_max_rss": "155328", "process_out_blocks": "2136", "process_user_time": 2.973279}
[0m10:52:54.761979 [debug] [MainThread]: Command `dbt run` failed at 10:52:54.761807 after 1.49 seconds
[0m10:52:54.762637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c131985a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c131c29b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c125e80830>]}
[0m10:52:54.763352 [debug] [MainThread]: Flushing usage events
[0m10:52:54.940289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:21.126204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9c289280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9c74e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9c4c3d40>]}


============================== 10:57:21.133222 | b5adbedc-a7a3-4790-8637-fef874ca3b93 ==============================
[0m10:57:21.133222 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:57:21.134547 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'warn_error': 'None', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt'}
[0m10:57:21.494664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8fff5790>]}
[0m10:57:21.600450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9bbae2a0>]}
[0m10:57:21.605172 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m10:57:21.762219 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m10:57:21.929874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:21.931789 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m10:57:22.544807 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m10:57:22.545959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8db57590>]}
[0m10:57:22.634349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9bbce540>]}
[0m10:57:22.737966 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:57:22.742881 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:57:22.958989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8dc7e270>]}
[0m10:57:22.960031 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m10:57:22.960645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8da30fe0>]}
[0m10:57:22.963225 [info ] [MainThread]: 
[0m10:57:22.963829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:22.964384 [info ] [MainThread]: 
[0m10:57:22.965326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:22.971764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m10:57:23.026390 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m10:57:23.027131 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m10:57:23.027685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:23.056363 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m10:57:23.059030 [debug] [ThreadPool]: On list_medallion: Close
[0m10:57:23.060327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m10:57:23.061265 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m10:57:23.072032 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:57:23.073661 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m10:57:23.074236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:23.076937 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:57:23.078939 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:57:23.079452 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m10:57:23.080676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:57:23.081192 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:57:23.081624 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m10:57:23.082777 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:57:23.084190 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:57:23.085038 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m10:57:23.085682 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m10:57:23.087248 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:57:23.087763 [debug] [ThreadPool]: On create_medallion_main: Close
[0m10:57:23.090102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m10:57:23.097760 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:57:23.098357 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m10:57:23.098897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:23.100738 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:57:23.101328 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m10:57:23.101903 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m10:57:23.122553 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m10:57:23.127447 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m10:57:23.129908 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m10:57:23.130461 [debug] [ThreadPool]: On list_medallion_main: Close
[0m10:57:23.132540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8dd78830>]}
[0m10:57:23.133515 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:23.134036 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.134623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:23.136644 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:57:23.137174 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.137635 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:23.138061 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.139516 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:57:23.140164 [debug] [MainThread]: On master: Close
[0m10:57:23.147932 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m10:57:23.149196 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m10:57:23.150257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m10:57:23.150914 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m10:57:23.180195 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m10:57:23.181883 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m10:57:23.230797 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m10:57:23.233591 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.234768 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m10:57:23.235437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.237696 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:23.238601 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.239653 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m10:57:23.242387 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:23.255015 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.255998 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m10:57:23.258235 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:57:23.262965 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.263608 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m10:57:23.265315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:57:23.284209 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:57:23.285361 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.286075 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m10:57:23.294809 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m10:57:23.305821 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m10:57:23.307333 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m10:57:23.314839 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:57:23.319212 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m10:57:23.323014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9cc10aa0>]}
[0m10:57:23.324840 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.17s]
[0m10:57:23.326016 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m10:57:23.328409 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m10:57:23.329428 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m10:57:23.330455 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m10:57:23.331012 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m10:57:23.335915 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m10:57:23.337127 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m10:57:23.370855 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m10:57:23.372827 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:57:23.373529 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m10:57:23.374137 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:57:23.376811 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m10:57:23.377607 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m10:57:23.378344 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:57:23.380214 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select * from "medallion"."main"."stg_transactions"
)

-- TODO: Completar el modelo para que cree la tabla fct_customer_transactions con las metricas en schema.yml.
    );
  
  
[0m10:57:23.381126 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m10:57:23.382307 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m10:57:23.388963 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m10:57:23.389599 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m10:57:23.393157 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:57:23.394174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5adbedc-a7a3-4790-8637-fef874ca3b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8d0f1670>]}
[0m10:57:23.395574 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.06s]
[0m10:57:23.396864 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m10:57:23.397964 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^.
[0m10:57:23.403276 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:23.403932 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.404493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:23.406276 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:57:23.406817 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.407283 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:23.407722 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.409094 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:57:23.409606 [debug] [MainThread]: On master: Close
[0m10:57:23.410253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:23.410682 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m10:57:23.411153 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m10:57:23.411653 [info ] [MainThread]: 
[0m10:57:23.412256 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m10:57:23.413617 [debug] [MainThread]: Command end result
[0m10:57:23.458034 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m10:57:23.462311 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m10:57:23.473904 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m10:57:23.474885 [info ] [MainThread]: 
[0m10:57:23.475724 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:57:23.476350 [info ] [MainThread]: 
[0m10:57:23.477199 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m10:57:23.477975 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:     );
               ^
[0m10:57:23.478564 [info ] [MainThread]: 
[0m10:57:23.479195 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m10:57:23.479767 [info ] [MainThread]: 
[0m10:57:23.480510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:57:23.481621 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:57:23.483662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4552853, "process_in_blocks": "0", "process_kernel_time": 0.764102, "process_mem_max_rss": "158172", "process_out_blocks": "3128", "process_user_time": 3.900559}
[0m10:57:23.484838 [debug] [MainThread]: Command `dbt run` failed at 10:57:23.484300 after 2.46 seconds
[0m10:57:23.485993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9c3cd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d8dd43c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2d9da69cd0>]}
[0m10:57:23.486643 [debug] [MainThread]: Flushing usage events
[0m10:57:24.709556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:43.184244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0aea508c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0aeda1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0af3773e0>]}


============================== 12:10:43.191395 | 6008a078-e712-40c3-9ebc-d6b84a319582 ==============================
[0m12:10:43.191395 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:10:43.192094 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'introspect': 'True', 'version_check': 'True'}
[0m12:10:43.587972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0b0d3d700>]}
[0m12:10:43.651513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0ae3646e0>]}
[0m12:10:43.654473 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:10:43.768939 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:10:43.891448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:43.892506 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m12:10:44.481819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f07e1711f0>]}
[0m12:10:44.571968 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:10:44.576239 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:10:44.757914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f07e188d10>]}
[0m12:10:44.759444 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:10:44.760225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f07e188ec0>]}
[0m12:10:44.763747 [info ] [MainThread]: 
[0m12:10:44.764490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:44.764962 [info ] [MainThread]: 
[0m12:10:44.765853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:10:44.772065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:10:44.835972 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:10:44.836940 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:10:44.837351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:44.877615 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m12:10:44.879733 [debug] [ThreadPool]: On list_medallion: Close
[0m12:10:44.880720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:10:44.881417 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:10:44.893497 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:10:44.894141 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:10:44.894612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:44.897914 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:10:44.900104 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:10:44.900674 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:10:44.902327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:10:44.902929 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:10:44.903468 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:10:44.905673 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:10:44.907401 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:10:44.908136 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:10:44.908649 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:10:44.910177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:10:44.910694 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:10:44.912637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:10:44.919104 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:10:44.919739 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:10:44.920184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:44.921860 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:10:44.922599 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:10:44.923087 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:10:44.947387 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:10:44.950223 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:10:44.951763 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:10:44.952184 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:10:44.953577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0aed2f200>]}
[0m12:10:44.954339 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:44.954992 [debug] [MainThread]: On master: BEGIN
[0m12:10:44.955412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:44.957974 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:10:44.958808 [debug] [MainThread]: On master: COMMIT
[0m12:10:44.959309 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:44.959875 [debug] [MainThread]: On master: COMMIT
[0m12:10:44.961252 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:10:44.961720 [debug] [MainThread]: On master: Close
[0m12:10:44.967550 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:10:44.968373 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:10:44.968988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:10:44.969525 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:10:44.985060 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:10:44.986287 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:10:45.025058 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:10:45.026387 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.026808 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:10:45.027165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:45.030978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:10:45.031879 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.032348 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:10:45.038495 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:10:45.045574 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.046419 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:10:45.048858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:10:45.052223 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.052958 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:10:45.055111 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:10:45.074170 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:10:45.075136 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.075582 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:10:45.087891 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:10:45.095456 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:10:45.096185 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:10:45.105787 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:10:45.110394 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:10:45.113600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f07d780530>]}
[0m12:10:45.114982 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.14s]
[0m12:10:45.115658 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:10:45.117820 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:10:45.118923 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:10:45.119924 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:10:45.120496 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:10:45.125426 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:10:45.126301 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:10:45.149863 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:10:45.151524 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:10:45.152189 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:10:45.152626 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:10:45.153981 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:10:45.154378 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:10:45.154736 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:10:45.160160 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:10:45.161264 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:10:45.162046 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m12:10:45.170076 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m12:10:45.170576 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:10:45.173131 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:10:45.174290 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6008a078-e712-40c3-9ebc-d6b84a319582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f07d6c7c80>]}
[0m12:10:45.176634 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.05s]
[0m12:10:45.177678 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:10:45.178422 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^.
[0m12:10:45.182684 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:45.183107 [debug] [MainThread]: On master: BEGIN
[0m12:10:45.183439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:45.185152 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:10:45.185612 [debug] [MainThread]: On master: COMMIT
[0m12:10:45.185966 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:45.186273 [debug] [MainThread]: On master: COMMIT
[0m12:10:45.187249 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:10:45.187750 [debug] [MainThread]: On master: Close
[0m12:10:45.188293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:45.188597 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:10:45.188880 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:10:45.189331 [info ] [MainThread]: 
[0m12:10:45.189794 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:10:45.190828 [debug] [MainThread]: Command end result
[0m12:10:45.225774 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:10:45.230272 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:10:45.237923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:10:45.238601 [info ] [MainThread]: 
[0m12:10:45.239209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:45.239645 [info ] [MainThread]: 
[0m12:10:45.240159 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m12:10:45.240629 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:10:45.241009 [info ] [MainThread]: 
[0m12:10:45.241467 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m12:10:45.241901 [info ] [MainThread]: 
[0m12:10:45.242790 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:10:45.244601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1236153, "process_in_blocks": "0", "process_kernel_time": 0.744769, "process_mem_max_rss": "158672", "process_out_blocks": "3120", "process_user_time": 3.089689}
[0m12:10:45.245433 [debug] [MainThread]: Command `dbt run` failed at 12:10:45.245101 after 2.12 seconds
[0m12:10:45.246195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0b27b3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0ae5a9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f0a238a120>]}
[0m12:10:45.247906 [debug] [MainThread]: Flushing usage events
[0m12:10:46.082118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:12.910279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d238d1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23593cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d2314d1c0>]}


============================== 12:11:12.914534 | 2e2b95a4-f6fc-481e-8edf-555f19422a7c ==============================
[0m12:11:12.914534 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:11:12.915108 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles'}
[0m12:11:13.198311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d226585f0>]}
[0m12:11:13.266064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d2281f6e0>]}
[0m12:11:13.268420 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:11:13.395508 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:11:13.526949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:13.528773 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m12:11:13.931768 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:11:13.932539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d147bc500>]}
[0m12:11:13.990657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d14654560>]}
[0m12:11:14.062823 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:11:14.066523 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:11:14.207356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d14687860>]}
[0m12:11:14.207993 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:11:14.208387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d14446f00>]}
[0m12:11:14.210250 [info ] [MainThread]: 
[0m12:11:14.210680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:14.211028 [info ] [MainThread]: 
[0m12:11:14.211573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:14.217036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:11:14.262652 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:11:14.263223 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:11:14.263628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:14.283471 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:11:14.285404 [debug] [ThreadPool]: On list_medallion: Close
[0m12:11:14.286617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:11:14.288028 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:11:14.294836 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:14.295315 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:11:14.295633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:14.297734 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:11:14.298938 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:14.299251 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:11:14.300331 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:14.300808 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:14.301249 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:11:14.301953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:14.302984 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:14.303307 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:14.303605 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:14.304498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:14.304943 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:11:14.307027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:11:14.312241 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:14.312603 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:11:14.312901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:14.314231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:14.314780 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:14.315092 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:11:14.328119 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:11:14.329903 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:11:14.330995 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:11:14.331360 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:11:14.332565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d146f0320>]}
[0m12:11:14.333160 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:14.333478 [debug] [MainThread]: On master: BEGIN
[0m12:11:14.333797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:14.334690 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:14.335008 [debug] [MainThread]: On master: COMMIT
[0m12:11:14.335324 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:14.335683 [debug] [MainThread]: On master: COMMIT
[0m12:11:14.336460 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:14.336777 [debug] [MainThread]: On master: Close
[0m12:11:14.341534 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:11:14.342588 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:11:14.343220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:11:14.343602 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:11:14.354471 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:11:14.355306 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:11:14.386862 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:11:14.388017 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.388419 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:11:14.388771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:14.390112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:14.390550 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.390992 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:11:14.393071 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:14.400451 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.401033 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:11:14.402732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:14.405571 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.405968 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:11:14.406919 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:14.418887 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:14.419489 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.419903 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:14.427859 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:11:14.434669 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:14.435450 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:11:14.443193 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:11:14.446822 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:11:14.448916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23610b30>]}
[0m12:11:14.449812 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.10s]
[0m12:11:14.450824 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:11:14.452428 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:11:14.453589 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:11:14.454838 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:14.455297 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:11:14.459688 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:14.460688 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:11:14.481547 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:14.482513 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:14.482900 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:11:14.483249 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:11:14.484534 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:11:14.484920 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:14.485360 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:11:14.486452 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:11:14.487032 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:11:14.487742 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m12:11:14.492080 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:14.492526 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:11:14.494682 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:11:14.495398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2b95a4-f6fc-481e-8edf-555f19422a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d14215640>]}
[0m12:11:14.496360 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.04s]
[0m12:11:14.496995 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:11:14.497664 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^.
[0m12:11:14.500770 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:14.501143 [debug] [MainThread]: On master: BEGIN
[0m12:11:14.501450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:14.502355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:14.502671 [debug] [MainThread]: On master: COMMIT
[0m12:11:14.502976 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:14.503301 [debug] [MainThread]: On master: COMMIT
[0m12:11:14.504105 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:14.504536 [debug] [MainThread]: On master: Close
[0m12:11:14.505084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:14.505395 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:11:14.505760 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:11:14.506123 [info ] [MainThread]: 
[0m12:11:14.506589 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m12:11:14.507547 [debug] [MainThread]: Command end result
[0m12:11:14.539642 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:11:14.542844 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:11:14.550045 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:11:14.550598 [info ] [MainThread]: 
[0m12:11:14.551179 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:14.551613 [info ] [MainThread]: 
[0m12:11:14.552228 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m12:11:14.552680 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:11:14.553068 [info ] [MainThread]: 
[0m12:11:14.553488 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m12:11:14.553851 [info ] [MainThread]: 
[0m12:11:14.554262 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:11:14.554964 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:11:14.556371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7049654, "process_in_blocks": "0", "process_kernel_time": 0.5184, "process_mem_max_rss": "157964", "process_out_blocks": "3120", "process_user_time": 2.827307}
[0m12:11:14.556862 [debug] [MainThread]: Command `dbt run` failed at 12:11:14.556761 after 1.71 seconds
[0m12:11:14.557282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d234a3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d24d962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d1455e540>]}
[0m12:11:14.557768 [debug] [MainThread]: Flushing usage events
[0m12:11:15.342743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:46.473487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca87d3bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca847c42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca84c86b70>]}


============================== 12:11:46.480286 | 58bef751-d2fa-4c09-b783-236503b1b2bb ==============================
[0m12:11:46.480286 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:11:46.481222 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m12:11:46.785053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca78316fc0>]}
[0m12:11:46.872317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca84039be0>]}
[0m12:11:46.874496 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:11:47.002897 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:11:47.129499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:47.130339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:47.178155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca83f9ddc0>]}
[0m12:11:47.260316 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:11:47.263816 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:11:47.288649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca77f31670>]}
[0m12:11:47.289568 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:11:47.290134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca783a3cb0>]}
[0m12:11:47.293025 [info ] [MainThread]: 
[0m12:11:47.293588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:47.294054 [info ] [MainThread]: 
[0m12:11:47.295567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:47.303391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:11:47.370307 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:11:47.371377 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:11:47.371932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:47.398149 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m12:11:47.401096 [debug] [ThreadPool]: On list_medallion: Close
[0m12:11:47.402412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:11:47.403096 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:11:47.414026 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.415029 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:11:47.415391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:47.418001 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:11:47.419996 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.420510 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:11:47.421490 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:47.421833 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.422142 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:11:47.423201 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:47.424476 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:47.424918 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:11:47.425278 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:11:47.426008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:47.426411 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:11:47.428995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:11:47.437392 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:47.438037 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:11:47.438368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:47.440444 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:11:47.440831 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:11:47.441170 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:11:47.455944 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:11:47.458958 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:11:47.460909 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:11:47.461349 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:11:47.463054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca83e33080>]}
[0m12:11:47.464041 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.464584 [debug] [MainThread]: On master: BEGIN
[0m12:11:47.465041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:47.466994 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:11:47.467428 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.467840 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.468336 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.469719 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:11:47.470218 [debug] [MainThread]: On master: Close
[0m12:11:47.477434 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:11:47.478558 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:11:47.479392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:11:47.480075 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:11:47.494410 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:11:47.495826 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:11:47.532304 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:11:47.533402 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.533866 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:11:47.534241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:47.536205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:47.536803 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.537238 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:11:47.539633 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:47.548462 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.548874 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:11:47.549959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.552450 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.553144 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:11:47.555109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:47.567851 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:47.568453 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.568863 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:11:47.577328 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:11:47.585217 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:11:47.585751 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:11:47.594031 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:11:47.598540 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:11:47.600331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca783165a0>]}
[0m12:11:47.601022 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.12s]
[0m12:11:47.601687 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:11:47.603263 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.603832 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:11:47.604556 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:47.604937 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.607831 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.608761 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.629093 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.630327 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.631084 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:11:47.631658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:11:47.633997 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:11:47.634487 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:11:47.634880 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:11:47.636015 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg;
    );
  
  
[0m12:11:47.636483 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:11:47.637091 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: ROLLBACK
[0m12:11:47.643033 [debug] [Thread-3 (]: Failed to rollback 'model.medallion_dbt.fct_customer_transactions'
[0m12:11:47.643459 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:11:47.647207 [debug] [Thread-3 (]: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:11:47.648850 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58bef751-d2fa-4c09-b783-236503b1b2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca78314fb0>]}
[0m12:11:47.649980 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.04s]
[0m12:11:47.650758 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:11:47.651465 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^.
[0m12:11:47.656095 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.656679 [debug] [MainThread]: On master: BEGIN
[0m12:11:47.657186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:47.658870 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:11:47.659286 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.659625 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:47.659934 [debug] [MainThread]: On master: COMMIT
[0m12:11:47.660857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:47.661263 [debug] [MainThread]: On master: Close
[0m12:11:47.661929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:47.662506 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:11:47.662941 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:11:47.663513 [info ] [MainThread]: 
[0m12:11:47.664071 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:11:47.665359 [debug] [MainThread]: Command end result
[0m12:11:47.702745 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:11:47.707352 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:11:47.715131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:11:47.715769 [info ] [MainThread]: 
[0m12:11:47.716449 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:47.717187 [info ] [MainThread]: 
[0m12:11:47.717998 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m12:11:47.718578 [error] [MainThread]:   Runtime Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 27: from agg;
                   ^
[0m12:11:47.719179 [info ] [MainThread]: 
[0m12:11:47.719767 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/fct_customer_transactions.sql
[0m12:11:47.720386 [info ] [MainThread]: 
[0m12:11:47.720989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:11:47.723618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3220077, "process_in_blocks": "0", "process_kernel_time": 0.577583, "process_mem_max_rss": "155560", "process_out_blocks": "2136", "process_user_time": 2.516351}
[0m12:11:47.724628 [debug] [MainThread]: Command `dbt run` failed at 12:11:47.724445 after 1.32 seconds
[0m12:11:47.725266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca84c86b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca84e4bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca84ff1760>]}
[0m12:11:47.725760 [debug] [MainThread]: Flushing usage events
[0m12:11:48.540915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:31.972377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aaf7e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aabf16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aabf26c0>]}


============================== 12:18:31.978539 | 7edc6d98-d76f-46c2-8bda-765271a33e1a ==============================
[0m12:18:31.978539 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:18:31.979401 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs'}
[0m12:18:32.272426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2acc690d0>]}
[0m12:18:32.343940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29e7e2de0>]}
[0m12:18:32.346608 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:18:32.460023 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:18:32.586315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:18:32.587696 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m12:18:32.588338 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m12:18:30.615851 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:18:30.616944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c776480>]}
[0m12:18:30.682862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c170080>]}
[0m12:18:30.913006 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:18:30.917767 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:18:30.943097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c1b3710>]}
[0m12:18:30.944265 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:18:30.945072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ab211070>]}
[0m12:18:30.947660 [info ] [MainThread]: 
[0m12:18:30.948090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:30.948533 [info ] [MainThread]: 
[0m12:18:30.949470 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:30.957117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:18:31.012471 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:18:31.013360 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:18:31.013773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:31.032906 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:18:31.035418 [debug] [ThreadPool]: On list_medallion: Close
[0m12:18:31.036329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:18:31.036832 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:18:31.044477 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:18:31.045109 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:18:31.045436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:31.047391 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:18:31.049024 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:18:31.049614 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:18:31.050324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:18:31.050630 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:18:31.050926 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:18:31.051730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:18:31.052781 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:18:31.053112 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:18:31.053417 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:18:31.054235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:18:31.054736 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:18:31.057291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:18:31.063769 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:18:31.064475 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:18:31.064868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:31.066572 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:18:31.067012 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:18:31.067334 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:18:31.080930 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:18:31.084179 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:18:31.085745 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:18:31.086123 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:18:31.087549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c1b2e10>]}
[0m12:18:31.088350 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:31.088842 [debug] [MainThread]: On master: BEGIN
[0m12:18:31.089297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:31.090915 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:18:31.091354 [debug] [MainThread]: On master: COMMIT
[0m12:18:31.091880 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:31.092219 [debug] [MainThread]: On master: COMMIT
[0m12:18:31.093414 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:31.093811 [debug] [MainThread]: On master: Close
[0m12:18:31.100191 [debug] [Thread-1 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:18:31.101127 [debug] [Thread-2 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:18:31.102254 [info ] [Thread-1 (]: 1 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:18:31.103335 [info ] [Thread-2 (]: 2 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:18:31.104449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.fct_customer_transactions)
[0m12:18:31.105293 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.medallion_dbt.stg_transactions'
[0m12:18:31.105812 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:18:31.106400 [debug] [Thread-2 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:18:31.124904 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:18:31.126609 [debug] [Thread-2 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:18:31.164673 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:18:31.167325 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.168519 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:18:31.170354 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:31.172947 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:18:31.174171 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.175026 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:18:31.178501 [debug] [Thread-1 (]: Compilation Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  dbt was unable to infer all dependencies for the model "fct_customer_transactions".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "fct_customer_transactions":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:18:31.179058 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:18:31.181917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c171790>]}
[0m12:18:31.192888 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.194433 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.fct_customer_transactions ........... [[31mERROR[0m in 0.08s]
[0m12:18:31.195121 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:18:31.195938 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:18:31.197563 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.fct_customer_transactions' to be skipped because of status 'error'.  Reason: Compilation Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  dbt was unable to infer all dependencies for the model "fct_customer_transactions".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "fct_customer_transactions":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:18:31.199230 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:18:31.203106 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.203603 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:18:31.205195 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:18:31.218233 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:18:31.218671 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.219049 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:18:31.228016 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:18:31.240044 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:18:31.241261 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:18:31.249892 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m12:18:31.254798 [debug] [Thread-2 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:18:31.255844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7edc6d98-d76f-46c2-8bda-765271a33e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28c122cf0>]}
[0m12:18:31.256909 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.15s]
[0m12:18:31.257859 [debug] [Thread-2 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:18:31.261980 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:31.262699 [debug] [MainThread]: On master: BEGIN
[0m12:18:31.263148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:31.264703 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:31.265074 [debug] [MainThread]: On master: COMMIT
[0m12:18:31.265399 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:31.265750 [debug] [MainThread]: On master: COMMIT
[0m12:18:31.266709 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:18:31.267212 [debug] [MainThread]: On master: Close
[0m12:18:31.267753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:31.268071 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:18:31.268355 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:18:31.269117 [info ] [MainThread]: 
[0m12:18:31.269804 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m12:18:31.270802 [debug] [MainThread]: Command end result
[0m12:18:31.302873 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:18:31.306781 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:18:31.314626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:18:31.315483 [info ] [MainThread]: 
[0m12:18:31.316224 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:18:31.316801 [info ] [MainThread]: 
[0m12:18:31.317323 [error] [MainThread]: [31mFailure in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)[0m
[0m12:18:31.317780 [error] [MainThread]:   Compilation Error in model fct_customer_transactions (models/marts/fct_customer_transactions.sql)
  dbt was unable to infer all dependencies for the model "fct_customer_transactions".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "fct_customer_transactions":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:18:31.318170 [info ] [MainThread]: 
[0m12:18:31.318709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:18:31.319474 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:18:31.321033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8741773, "process_in_blocks": "384", "process_kernel_time": 0.492663, "process_mem_max_rss": "158612", "process_out_blocks": "3088", "process_user_time": 3.062599}
[0m12:18:31.321636 [debug] [MainThread]: Command `dbt run` failed at 12:18:31.321518 after 1.88 seconds
[0m12:18:31.322153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2aa93bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c0f1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c0f17f0>]}
[0m12:18:31.322603 [debug] [MainThread]: Flushing usage events
[0m12:18:32.133513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:25.216997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7775023c9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7775021446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777502ac1f70>]}


============================== 12:21:25.222082 | 6ff1d936-91ae-466e-a371-8afd74f2d5d9 ==============================
[0m12:21:25.222082 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:21:25.222745 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'static_parser': 'True', 'printer_width': '80'}
[0m12:21:25.494260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777501ab6cf0>]}
[0m12:21:25.558281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7775019fe810>]}
[0m12:21:25.560878 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:21:25.669176 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:21:25.770627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:25.771438 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m12:21:26.308749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7774d1a9eb40>]}
[0m12:21:26.389509 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:21:26.393921 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:21:26.533527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7774d1ab0fb0>]}
[0m12:21:26.534165 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:21:26.534582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7774d1ab10a0>]}
[0m12:21:26.536910 [info ] [MainThread]: 
[0m12:21:26.537613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:26.538069 [info ] [MainThread]: 
[0m12:21:26.539180 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:26.547012 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:21:26.591484 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:21:26.592251 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:21:26.592726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:26.613781 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:21:26.616189 [debug] [ThreadPool]: On list_medallion: Close
[0m12:21:26.617136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:21:26.617604 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:21:26.624612 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:21:26.624971 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:21:26.625297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:26.626467 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:21:26.628237 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:21:26.629207 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:21:26.631119 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:21:26.631481 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:21:26.631801 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:21:26.632635 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:21:26.633836 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:21:26.634196 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:21:26.634504 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:21:26.635424 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:21:26.636030 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:21:26.638433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:21:26.646357 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:21:26.647051 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:21:26.647399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:26.649256 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:21:26.649641 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:21:26.649965 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:21:26.662393 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:21:26.664365 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:21:26.665752 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:21:26.666093 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:21:26.667405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777502951070>]}
[0m12:21:26.668122 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:26.668584 [debug] [MainThread]: On master: BEGIN
[0m12:21:26.668904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:26.670179 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:21:26.670650 [debug] [MainThread]: On master: COMMIT
[0m12:21:26.671196 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:26.671537 [debug] [MainThread]: On master: COMMIT
[0m12:21:26.672525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:21:26.672947 [debug] [MainThread]: On master: Close
[0m12:21:26.677504 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:21:26.678212 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:21:26.678782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:21:26.679307 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:21:26.696452 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:21:26.697826 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:21:26.728205 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:21:26.729248 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.729728 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:21:26.730171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:26.731380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:21:26.731782 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.732144 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:21:26.734147 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:21:26.741705 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.742333 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:21:26.744036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:21:26.747925 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.748311 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:21:26.749161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:21:26.761541 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:21:26.762454 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.762833 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:21:26.775324 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m12:21:26.783299 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:21:26.783786 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:21:26.791280 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:21:26.795874 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:21:26.798022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7774d1a19f10>]}
[0m12:21:26.799001 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.12s]
[0m12:21:26.799782 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:21:26.801267 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:21:26.802776 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:21:26.803528 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:21:26.803972 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:21:26.808257 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.809571 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:21:26.829302 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.830282 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.830703 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:21:26.831114 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:21:26.832776 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:21:26.833276 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.833643 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- depends_on: "medallion"."main"."stg_transactions"

with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg
    );
  
  
[0m12:21:26.860894 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m12:21:26.866541 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.867423 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m12:21:26.870031 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:21:26.875879 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:21:26.876304 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.876659 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:21:26.885413 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m12:21:26.889741 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:21:26.890193 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m12:21:26.891672 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:21:26.894425 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:21:26.895494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff1d936-91ae-466e-a371-8afd74f2d5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7774d1a9ce90>]}
[0m12:21:26.896306 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.09s]
[0m12:21:26.896931 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:21:26.899920 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:26.901003 [debug] [MainThread]: On master: BEGIN
[0m12:21:26.901337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:26.903002 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:21:26.903508 [debug] [MainThread]: On master: COMMIT
[0m12:21:26.903993 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:26.904437 [debug] [MainThread]: On master: COMMIT
[0m12:21:26.905263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:21:26.905625 [debug] [MainThread]: On master: Close
[0m12:21:26.906111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:26.906416 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:21:26.906702 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:21:26.907202 [info ] [MainThread]: 
[0m12:21:26.907762 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:21:26.908700 [debug] [MainThread]: Command end result
[0m12:21:26.941537 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:21:26.945621 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:21:26.952530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:21:26.953044 [info ] [MainThread]: 
[0m12:21:26.953693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:26.954266 [info ] [MainThread]: 
[0m12:21:26.954849 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:21:26.956521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8007195, "process_in_blocks": "4240", "process_kernel_time": 0.565951, "process_mem_max_rss": "159736", "process_out_blocks": "3128", "process_user_time": 2.86627}
[0m12:21:26.957267 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:26.957086 after 1.80 seconds
[0m12:21:26.957932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777502afb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777502afaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777501ad5250>]}
[0m12:21:26.958511 [debug] [MainThread]: Flushing usage events
[0m12:21:27.804490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:31.791877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe215849e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe218db200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe20f18680>]}


============================== 12:21:31.796800 | cd042213-8693-433f-9fd5-d027cfaf3a0e ==============================
[0m12:21:31.796800 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:21:31.797393 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'empty': 'None'}
[0m12:21:32.042081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe203a8f20>]}
[0m12:21:32.104522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe149031d0>]}
[0m12:21:32.106568 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:21:32.211732 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:21:32.312775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:32.313325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:32.354673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe149e3f50>]}
[0m12:21:32.446873 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:21:32.449576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:21:32.512227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbdf675f650>]}
[0m12:21:32.513170 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:21:32.513612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe204d3260>]}
[0m12:21:32.516433 [info ] [MainThread]: 
[0m12:21:32.516964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:32.517383 [info ] [MainThread]: 
[0m12:21:32.518174 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:32.525379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:21:32.584271 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:21:32.584887 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:21:32.585342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:32.609744 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:21:32.610362 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:21:32.610799 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:21:32.627667 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:21:32.629752 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:21:32.631162 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:21:32.631536 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:21:32.633389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd042213-8693-433f-9fd5-d027cfaf3a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe1497a930>]}
[0m12:21:32.633979 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:32.634382 [debug] [MainThread]: On master: BEGIN
[0m12:21:32.634740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:32.636139 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:21:32.636550 [debug] [MainThread]: On master: COMMIT
[0m12:21:32.636992 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:32.637330 [debug] [MainThread]: On master: COMMIT
[0m12:21:32.638093 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:21:32.638439 [debug] [MainThread]: On master: Close
[0m12:21:32.642848 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:21:32.643511 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:21:32.644162 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:21:32.644722 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:21:32.645334 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m12:21:32.646148 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m12:21:32.647011 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m12:21:32.647903 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m12:21:32.648981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m12:21:32.649834 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:21:32.650474 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:21:32.651146 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:21:32.651727 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:21:32.652273 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:21:32.652872 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:21:32.653525 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:21:32.675798 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:21:32.681530 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:21:32.686633 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:21:32.691846 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:21:32.692877 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:21:32.715602 [debug] [Thread-1 (]: Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.717810 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:21:32.718476 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:21:32.721403 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:21:32.722328 [error] [Thread-1 (]: 1 of 16 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.07s]
[0m12:21:32.725752 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:21:32.727113 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:21:32.728766 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:21:32.729565 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:21:32.730747 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.731251 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:21:32.731799 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:21:32.732365 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m12:21:32.733062 [info ] [Thread-1 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m12:21:32.735005 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m12:21:32.735581 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m12:21:32.736084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:21:32.736707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m12:21:32.737516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:21:32.738221 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:21:32.739876 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:21:32.741216 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m12:21:32.742189 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:21:32.747507 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m12:21:32.748011 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:21:32.749194 [debug] [Thread-1 (]: Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.749589 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:21:32.750025 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:21:32.750605 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m12:21:32.751287 [error] [Thread-1 (]: 5 of 16 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.01s]
[0m12:21:32.751935 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m12:21:32.752579 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m12:21:32.753606 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:21:32.754943 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:21:32.755799 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.757526 [info ] [Thread-1 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m12:21:32.758534 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:21:32.759089 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:21:32.759931 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:21:32.760646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m12:21:32.768674 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m12:21:32.766693 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m12:21:32.770482 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m12:21:32.771075 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:21:32.772561 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:21:32.773815 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:21:32.775124 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:21:32.783518 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:21:32.784181 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m12:21:32.784886 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m12:21:32.785704 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m12:21:32.787001 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.14s]
[0m12:21:32.788491 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:21:32.787827 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.14s]
[0m12:21:32.789909 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:21:32.789323 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.14s]
[0m12:21:32.792577 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:21:32.793579 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:21:32.794341 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:21:32.795191 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:21:32.796066 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:21:32.797235 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:21:32.797908 [info ] [Thread-3 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m12:21:32.798705 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:21:32.799257 [info ] [Thread-2 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m12:21:32.799797 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m12:21:32.800504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m12:21:32.801107 [info ] [Thread-4 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m12:21:32.801917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m12:21:32.802514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:32.803046 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:21:32.803625 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m12:21:32.804087 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:21:32.810810 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:21:32.811862 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:21:32.812510 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m12:21:32.820509 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:21:32.824775 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:21:32.825531 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:21:32.826046 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:21:32.827142 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:21:32.827721 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:21:32.828243 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:21:32.830703 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:21:32.834324 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:21:32.836466 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:21:32.837045 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:21:32.838550 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:21:32.839388 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:21:32.841648 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m12:21:32.842316 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m12:21:32.842859 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:21:32.843469 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m12:21:32.844485 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m12:21:32.845041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:21:32.845860 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m12:21:32.846497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:21:32.847108 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m12:21:32.848992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:21:32.850046 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m12:21:32.850825 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:21:32.852065 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.09s]
[0m12:21:32.853121 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:21:32.853704 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:21:32.854087 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:21:32.854756 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:21:32.855312 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m12:21:32.855787 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:21:32.856301 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m12:21:32.856936 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:21:32.858320 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m12:21:32.859701 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m12:21:32.860847 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:21:32.861314 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:21:32.862075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m12:21:32.863947 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m12:21:32.864443 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:21:32.866435 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m12:21:32.867078 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:21:32.868176 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m12:21:32.869640 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m12:21:32.870442 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m12:21:32.874796 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m12:21:32.876194 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.877410 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m12:21:32.877948 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m12:21:32.878645 [error] [Thread-1 (]: 10 of 16 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.02s]
[0m12:21:32.880167 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m12:21:32.879342 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.08s]
[0m12:21:32.881320 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.08s]
[0m12:21:32.884529 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:21:32.883624 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:21:32.882876 [info ] [Thread-4 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.08s]
[0m12:21:32.882048 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:21:32.885195 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:21:32.885942 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:21:32.886772 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:21:32.887450 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:21:32.887963 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.888609 [info ] [Thread-2 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m12:21:32.889365 [info ] [Thread-3 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m12:21:32.889978 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:21:32.890462 [info ] [Thread-1 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m12:21:32.891441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m12:21:32.892062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m12:21:32.892609 [info ] [Thread-4 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m12:21:32.893514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m12:21:32.894189 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:21:32.894937 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:21:32.895527 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m12:21:32.896039 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:21:32.900409 [debug] [Thread-2 (]: Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.905658 [debug] [Thread-3 (]: Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.906341 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:21:32.910950 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.911485 [error] [Thread-2 (]: 11 of 16 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.02s]
[0m12:21:32.912215 [error] [Thread-3 (]: 12 of 16 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.02s]
[0m12:21:32.916508 [debug] [Thread-4 (]: Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.917094 [error] [Thread-1 (]: 13 of 16 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.02s]
[0m12:21:32.918025 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:21:32.918709 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:21:32.919252 [error] [Thread-4 (]: 14 of 16 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.02s]
[0m12:21:32.920503 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:21:32.921232 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:21:32.921823 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.922322 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:21:32.923098 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:21:32.923845 [info ] [Thread-2 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m12:21:32.924735 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.925223 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m12:21:32.926267 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m12:21:32.927044 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.927539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m12:21:32.927996 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:21:32.928710 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.929258 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:21:32.934756 [debug] [Thread-2 (]: Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.941129 [debug] [Thread-3 (]: Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:32.941736 [error] [Thread-2 (]: 15 of 16 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.02s]
[0m12:21:32.942342 [error] [Thread-3 (]: 16 of 16 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.01s]
[0m12:21:32.943160 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:21:32.944087 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:21:32.944741 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.945421 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:21:32.948290 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:32.948757 [debug] [MainThread]: On master: BEGIN
[0m12:21:32.949152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:32.950998 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:21:32.951366 [debug] [MainThread]: On master: COMMIT
[0m12:21:32.951743 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:32.952096 [debug] [MainThread]: On master: COMMIT
[0m12:21:32.952972 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:21:32.953375 [debug] [MainThread]: On master: Close
[0m12:21:32.953848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:32.954168 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m12:21:32.954486 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m12:21:32.954834 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m12:21:32.955216 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m12:21:32.955632 [info ] [MainThread]: 
[0m12:21:32.956095 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:21:32.958742 [debug] [MainThread]: Command end result
[0m12:21:33.165200 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:21:33.169177 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:21:33.177262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:21:33.177740 [info ] [MainThread]: 
[0m12:21:33.178305 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m12:21:33.178713 [info ] [MainThread]: 
[0m12:21:33.179273 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m12:21:33.179729 [error] [MainThread]:   Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.180198 [info ] [MainThread]: 
[0m12:21:33.180868 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m12:21:33.181514 [error] [MainThread]:   Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.181927 [info ] [MainThread]: 
[0m12:21:33.182381 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m12:21:33.182796 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.183369 [info ] [MainThread]: 
[0m12:21:33.183862 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m12:21:33.184317 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.184686 [info ] [MainThread]: 
[0m12:21:33.185160 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m12:21:33.185598 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.185964 [info ] [MainThread]: 
[0m12:21:33.186370 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m12:21:33.186784 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.187254 [info ] [MainThread]: 
[0m12:21:33.187670 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m12:21:33.188088 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.188601 [info ] [MainThread]: 
[0m12:21:33.189016 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m12:21:33.189475 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.189842 [info ] [MainThread]: 
[0m12:21:33.190248 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m12:21:33.190646 [error] [MainThread]:   Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:21:33.191042 [info ] [MainThread]: 
[0m12:21:33.191446 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=16
[0m12:21:33.192745 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.4604573, "process_in_blocks": "1336", "process_kernel_time": 0.459331, "process_mem_max_rss": "155360", "process_out_blocks": "2288", "process_user_time": 2.52072}
[0m12:21:33.193462 [debug] [MainThread]: Command `dbt test` failed at 12:21:33.193312 after 1.46 seconds
[0m12:21:33.194239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe214f7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe20b5b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbe22844530>]}
[0m12:21:33.195135 [debug] [MainThread]: Flushing usage events
[0m12:21:33.969358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:55.490599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22dddea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22c6b4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22c987cb0>]}


============================== 12:26:55.494451 | 88005669-9b83-4290-91c0-e05125452f3e ==============================
[0m12:26:55.494451 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:26:55.495061 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None'}
[0m12:26:55.761281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2203f9820>]}
[0m12:26:55.827065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22c0547a0>]}
[0m12:26:55.829054 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:26:55.940842 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:26:56.065047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:56.066311 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/schema.yml
[0m12:26:56.155353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2203275f0>]}
[0m12:26:56.227468 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:26:56.231636 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:26:56.251487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d21ff0bce0>]}
[0m12:26:56.252060 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:26:56.252453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d227d43860>]}
[0m12:26:56.254250 [info ] [MainThread]: 
[0m12:26:56.254773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:26:56.255276 [info ] [MainThread]: 
[0m12:26:56.256089 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:26:56.261623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:26:56.313055 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:26:56.313951 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:26:56.314315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:56.338251 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:26:56.340004 [debug] [ThreadPool]: On list_medallion: Close
[0m12:26:56.340965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:26:56.341426 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:26:56.350206 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:26:56.351068 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:26:56.351521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:56.354398 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:26:56.356786 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:26:56.357206 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:26:56.357915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:26:56.358273 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:26:56.358660 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:26:56.359699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:26:56.360563 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:26:56.361129 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:26:56.361546 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:26:56.362538 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:26:56.363195 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:26:56.365222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:26:56.371274 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:26:56.371944 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:26:56.372285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:56.374197 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:26:56.374798 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:26:56.375258 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:26:56.391920 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:26:56.395141 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:26:56.397286 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:26:56.397754 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:26:56.399795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22e85fbc0>]}
[0m12:26:56.400812 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:56.401465 [debug] [MainThread]: On master: BEGIN
[0m12:26:56.401926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:56.404126 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:26:56.404711 [debug] [MainThread]: On master: COMMIT
[0m12:26:56.405201 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:56.405524 [debug] [MainThread]: On master: COMMIT
[0m12:26:56.406449 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:26:56.407101 [debug] [MainThread]: On master: Close
[0m12:26:56.413901 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:26:56.414618 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:26:56.415172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:26:56.415575 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:26:56.425324 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:26:56.426173 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:26:56.458908 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:26:56.459979 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.460402 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:26:56.460760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:56.462705 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:56.463089 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.463484 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251210_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:26:56.465550 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:26:56.471233 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.471780 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:26:56.473138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:56.476124 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.476534 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:26:56.477413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:26:56.488675 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:26:56.489192 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.489606 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:26:56.497880 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:26:56.506026 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:26:56.506499 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:26:56.514788 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:26:56.520351 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:26:56.522264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d21d5aa600>]}
[0m12:26:56.523183 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.11s]
[0m12:26:56.523916 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:26:56.526384 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:26:56.527382 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:26:56.528535 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:26:56.529062 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:26:56.535602 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.536874 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:26:56.561301 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.562391 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.562964 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:26:56.563469 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:26:56.565141 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:26:56.565555 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.565924 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- depends_on: "medallion"."main"."stg_transactions"

with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg
    );
  
  
[0m12:26:56.571995 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:26:56.579249 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.579659 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m12:26:56.581072 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:26:56.583056 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.583496 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m12:26:56.585693 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:26:56.589744 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.590276 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m12:26:56.591271 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:26:56.593374 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.593759 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m12:26:56.594590 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:26:56.599186 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:26:56.599816 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.600253 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:26:56.607146 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:26:56.610712 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:26:56.611142 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m12:26:56.618228 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:26:56.620851 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:26:56.621782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88005669-9b83-4290-91c0-e05125452f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d21d5a9c10>]}
[0m12:26:56.622658 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.09s]
[0m12:26:56.623358 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:26:56.626458 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:56.626836 [debug] [MainThread]: On master: BEGIN
[0m12:26:56.627155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:56.628690 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:26:56.629195 [debug] [MainThread]: On master: COMMIT
[0m12:26:56.629516 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:56.629814 [debug] [MainThread]: On master: COMMIT
[0m12:26:56.630550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:26:56.631191 [debug] [MainThread]: On master: Close
[0m12:26:56.631774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:56.632070 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:26:56.632426 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:26:56.632865 [info ] [MainThread]: 
[0m12:26:56.633298 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m12:26:56.634517 [debug] [MainThread]: Command end result
[0m12:26:56.772658 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:26:56.777088 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:26:56.787820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:26:56.789475 [info ] [MainThread]: 
[0m12:26:56.790084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:56.790531 [info ] [MainThread]: 
[0m12:26:56.791048 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:26:56.792308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3655686, "process_in_blocks": "0", "process_kernel_time": 0.598878, "process_mem_max_rss": "157852", "process_out_blocks": "3152", "process_user_time": 2.487364}
[0m12:26:56.792860 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:56.792755 after 1.37 seconds
[0m12:26:56.793312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22ce47c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22c23d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d22c0b5cd0>]}
[0m12:26:56.793781 [debug] [MainThread]: Flushing usage events
[0m12:26:57.878513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:01.427318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb1ba52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb26c35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb2645cd0>]}


============================== 12:27:01.431766 | c4fdd747-3121-42eb-812b-eaadb67641d1 ==============================
[0m12:27:01.431766 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:27:01.432360 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'invocation_command': 'dbt test --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True'}
[0m12:27:01.686469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb17273e0>]}
[0m12:27:01.764183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fa5b06ff0>]}
[0m12:27:01.766792 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:27:01.895002 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:27:02.002775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:02.003495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:02.055087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fa5be3800>]}
[0m12:27:02.127201 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:27:02.130878 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:27:02.165568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9f837f0860>]}
[0m12:27:02.166190 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:27:02.166642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fa57e4410>]}
[0m12:27:02.169400 [info ] [MainThread]: 
[0m12:27:02.170079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:02.170481 [info ] [MainThread]: 
[0m12:27:02.171314 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:27:02.177383 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:27:02.221697 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:27:02.222366 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:27:02.223113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:02.243802 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:27:02.244823 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:27:02.245297 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:27:02.257097 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:27:02.258975 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:27:02.260550 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:27:02.260908 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:27:02.262907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fdd747-3121-42eb-812b-eaadb67641d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb15af0b0>]}
[0m12:27:02.263826 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:02.264235 [debug] [MainThread]: On master: BEGIN
[0m12:27:02.264562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:02.266349 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:27:02.266761 [debug] [MainThread]: On master: COMMIT
[0m12:27:02.267097 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:02.267405 [debug] [MainThread]: On master: COMMIT
[0m12:27:02.268220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:27:02.268784 [debug] [MainThread]: On master: Close
[0m12:27:02.274223 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:27:02.274867 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:27:02.275449 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:27:02.276724 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:27:02.276035 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m12:27:02.277536 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m12:27:02.278222 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m12:27:02.279152 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m12:27:02.280032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m12:27:02.280738 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:27:02.281328 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:27:02.282044 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:27:02.282578 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:27:02.283136 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:27:02.283657 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:27:02.284217 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:27:02.309084 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:27:02.314176 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:27:02.323070 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:27:02.326418 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:27:02.326947 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:27:02.339412 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:27:02.356684 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:27:02.357308 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:27:02.359613 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:27:02.363639 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:27:02.364394 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:27:02.365214 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m12:27:02.366415 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m12:27:02.367251 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:27:02.369206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:27:02.371095 [debug] [Thread-1 (]: Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.371760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:27:02.372376 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m12:27:02.374456 [error] [Thread-1 (]: 1 of 16 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.09s]
[0m12:27:02.376553 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:27:02.377361 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:27:02.377842 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m12:27:02.378805 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:27:02.379405 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:27:02.380234 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:27:02.381006 [debug] [Thread-1 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:27:02.381388 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.382152 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.382777 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m12:27:02.383460 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m12:27:02.384073 [info ] [Thread-1 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m12:27:02.384663 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:27:02.387642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m12:27:02.388492 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m12:27:02.389453 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:27:02.390134 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.390679 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.397369 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:27:02.399432 [debug] [Thread-1 (]: Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.404849 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m12:27:02.407356 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m12:27:02.408908 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m12:27:02.409673 [error] [Thread-1 (]: 5 of 16 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.02s]
[0m12:27:02.411369 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:27:02.412700 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:27:02.413591 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:27:02.414226 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:27:02.414767 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m12:27:02.415343 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m12:27:02.415912 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m12:27:02.416672 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:27:02.417473 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.418393 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.14s]
[0m12:27:02.419241 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.14s]
[0m12:27:02.420155 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.14s]
[0m12:27:02.420606 [info ] [Thread-1 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m12:27:02.421886 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:27:02.422773 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:27:02.423492 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:27:02.424171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m12:27:02.424888 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:27:02.425654 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:27:02.426380 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:27:02.427117 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:27:02.427660 [info ] [Thread-3 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m12:27:02.428278 [info ] [Thread-2 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m12:27:02.428833 [info ] [Thread-4 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m12:27:02.438370 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:27:02.439108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m12:27:02.439763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m12:27:02.440364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m12:27:02.441288 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:27:02.442164 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:27:02.442958 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:27:02.453561 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:27:02.454336 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:27:02.458004 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:27:02.463083 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:27:02.465962 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:27:02.468563 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:27:02.469123 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:27:02.469781 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:27:02.470299 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m12:27:02.470791 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:27:02.472772 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:27:02.475115 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:27:02.475697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:02.477680 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:27:02.480393 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:27:02.481059 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:27:02.481660 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:27:02.482329 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m12:27:02.483017 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:27:02.483507 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m12:27:02.484025 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:27:02.484502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:27:02.485571 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m12:27:02.486291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:27:02.486962 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:27:02.488006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:02.488842 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.489984 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.490867 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:27:02.491466 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:27:02.492203 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:27:02.492990 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:27:02.493522 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m12:27:02.494112 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:27:02.494570 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m12:27:02.497167 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m12:27:02.498672 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m12:27:02.501055 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:27:02.502369 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m12:27:02.503020 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:27:02.505269 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m12:27:02.505699 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:27:02.506281 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m12:27:02.507639 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m12:27:02.509076 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m12:27:02.510576 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m12:27:02.512203 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m12:27:02.511679 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.09s]
[0m12:27:02.513686 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m12:27:02.515255 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m12:27:02.517141 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:27:02.516481 [info ] [Thread-4 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.08s]
[0m12:27:02.517830 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m12:27:02.518402 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m12:27:02.519080 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:27:02.520238 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:27:02.521078 [info ] [Thread-2 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.08s]
[0m12:27:02.521745 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.08s]
[0m12:27:02.523173 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:27:02.522407 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m12:27:02.524134 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:27:02.524754 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:27:02.525297 [info ] [Thread-4 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m12:27:02.525940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m12:27:02.526505 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:27:02.527271 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:27:02.527976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m12:27:02.528449 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:27:02.528964 [info ] [Thread-2 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m12:27:02.529621 [info ] [Thread-3 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m12:27:02.530329 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:27:02.537259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m12:27:02.538113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m12:27:02.544908 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.545577 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:27:02.547048 [debug] [Thread-4 (]: Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.547637 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:27:02.548345 [error] [Thread-1 (]: 10 of 16 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.02s]
[0m12:27:02.554646 [error] [Thread-4 (]: 11 of 16 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.03s]
[0m12:27:02.556956 [debug] [Thread-2 (]: Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.563270 [debug] [Thread-3 (]: Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.564199 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:27:02.564876 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:27:02.565531 [error] [Thread-2 (]: 12 of 16 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.03s]
[0m12:27:02.566347 [error] [Thread-3 (]: 13 of 16 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.03s]
[0m12:27:02.567229 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:27:02.567780 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.568317 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:27:02.569063 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:27:02.569754 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:27:02.570538 [info ] [Thread-1 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m12:27:02.571590 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.572176 [info ] [Thread-4 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m12:27:02.572895 [debug] [Thread-2 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:27:02.573952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m12:27:02.574778 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.575366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m12:27:02.575835 [info ] [Thread-2 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m12:27:02.576585 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:27:02.577246 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.577700 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:27:02.578181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m12:27:02.727252 [debug] [Thread-1 (]: Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.729653 [debug] [Thread-4 (]: Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.730104 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:27:02.730794 [error] [Thread-1 (]: 14 of 16 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.16s]
[0m12:27:02.731552 [error] [Thread-4 (]: 15 of 16 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.16s]
[0m12:27:02.737704 [debug] [Thread-2 (]: Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.738733 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:27:02.739504 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:27:02.740224 [error] [Thread-2 (]: 16 of 16 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.16s]
[0m12:27:02.741261 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.742121 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:27:02.742904 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.743676 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}.
[0m12:27:02.747340 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:02.747773 [debug] [MainThread]: On master: BEGIN
[0m12:27:02.748129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:02.749638 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:27:02.750010 [debug] [MainThread]: On master: COMMIT
[0m12:27:02.750420 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:02.750855 [debug] [MainThread]: On master: COMMIT
[0m12:27:02.751948 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:27:02.752450 [debug] [MainThread]: On master: Close
[0m12:27:02.753070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:02.753408 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m12:27:02.753786 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m12:27:02.754079 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m12:27:02.754388 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m12:27:02.755108 [info ] [MainThread]: 
[0m12:27:02.755568 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:27:02.757623 [debug] [MainThread]: Command end result
[0m12:27:02.788473 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:27:02.793187 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:27:02.801667 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:27:02.802197 [info ] [MainThread]: 
[0m12:27:02.802768 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m12:27:02.803191 [info ] [MainThread]: 
[0m12:27:02.803697 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m12:27:02.804257 [error] [MainThread]:   Compilation Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "accepted_values_stg_transactions_status__completed__pending__failed".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "accepted_values_stg_transactions_status__completed__pending__failed":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.804653 [info ] [MainThread]: 
[0m12:27:02.805079 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m12:27:02.805493 [error] [MainThread]:   Compilation Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "non_negative_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "non_negative_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.805870 [info ] [MainThread]: 
[0m12:27:02.806367 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m12:27:02.806889 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_amount".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_amount":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.807364 [info ] [MainThread]: 
[0m12:27:02.808051 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m12:27:02.808612 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_customer_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_customer_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.809086 [info ] [MainThread]: 
[0m12:27:02.809646 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m12:27:02.810199 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_status".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_status":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.810837 [info ] [MainThread]: 
[0m12:27:02.811371 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m12:27:02.811846 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_date":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.812228 [info ] [MainThread]: 
[0m12:27:02.812651 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m12:27:02.813062 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.813449 [info ] [MainThread]: 
[0m12:27:02.813863 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m12:27:02.814812 [error] [MainThread]:   Compilation Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "not_null_stg_transactions_transaction_ts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "not_null_stg_transactions_transaction_ts":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.815189 [info ] [MainThread]: 
[0m12:27:02.815623 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m12:27:02.816028 [error] [MainThread]:   Compilation Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  dbt was unable to infer all dependencies for the model "unique_stg_transactions_transaction_id".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "unique_stg_transactions_transaction_id":
  
  -- depends_on: {{ ref('stg_transactions') }}
[0m12:27:02.816414 [info ] [MainThread]: 
[0m12:27:02.816837 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=16
[0m12:27:02.818437 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.4586633, "process_in_blocks": "0", "process_kernel_time": 0.532182, "process_mem_max_rss": "155824", "process_out_blocks": "2280", "process_user_time": 2.594848}
[0m12:27:02.819083 [debug] [MainThread]: Command `dbt test` failed at 12:27:02.818963 after 1.46 seconds
[0m12:27:02.819636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb1ea7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fa5a3e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9fb2645cd0>]}
[0m12:27:02.820137 [debug] [MainThread]: Flushing usage events
[0m12:27:03.586257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:48.898364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26c9c8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26cd66ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26ee013a0>]}


============================== 12:28:48.902633 | c87f363c-34de-4ad7-95cd-6cad5c75a12a ==============================
[0m12:28:48.902633 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:28:48.903528 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'version_check': 'True', 'printer_width': '80'}
[0m12:28:49.192957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d260509970>]}
[0m12:28:49.269219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26c9a0380>]}
[0m12:28:49.272483 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:28:49.386116 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:28:49.490904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:49.492471 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m12:28:49.875518 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m12:28:49.876340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2603fbda0>]}
[0m12:28:49.951073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d259f5e270>]}
[0m12:28:50.038034 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:28:50.041141 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:28:50.171019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d25a02dbe0>]}
[0m12:28:50.172310 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:28:50.172863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d25a00e240>]}
[0m12:28:50.176647 [info ] [MainThread]: 
[0m12:28:50.177575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:50.178073 [info ] [MainThread]: 
[0m12:28:50.179442 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:28:50.187218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m12:28:50.231867 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m12:28:50.232508 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m12:28:50.232842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:50.256552 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m12:28:50.259261 [debug] [ThreadPool]: On list_medallion: Close
[0m12:28:50.261126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m12:28:50.262709 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m12:28:50.271379 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:28:50.272093 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m12:28:50.272515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:50.275742 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:28:50.278037 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:28:50.278514 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m12:28:50.279904 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:28:50.280353 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:28:50.280779 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m12:28:50.281798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:28:50.283584 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:28:50.284090 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m12:28:50.284499 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m12:28:50.285406 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:28:50.286471 [debug] [ThreadPool]: On create_medallion_main: Close
[0m12:28:50.289441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m12:28:50.302487 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:28:50.303910 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:28:50.304635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:50.306760 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:28:50.307333 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:28:50.307736 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:28:50.325676 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:28:50.329088 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:28:50.331055 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:28:50.331467 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:28:50.333493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2595a43b0>]}
[0m12:28:50.335301 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:50.335736 [debug] [MainThread]: On master: BEGIN
[0m12:28:50.336219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:50.338405 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:28:50.339116 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.339562 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:50.339905 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.341227 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:28:50.341617 [debug] [MainThread]: On master: Close
[0m12:28:50.347477 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m12:28:50.348521 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m12:28:50.349445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m12:28:50.349986 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m12:28:50.364900 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m12:28:50.366395 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m12:28:50.403576 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m12:28:50.404835 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.405673 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m12:28:50.406252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:50.408391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:28:50.408853 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.409237 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/data/clean/transactions_20251201_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar)      as transaction_id,
    cast(customer_id as varchar)         as customer_id,
    cast(amount as double)               as amount,
    cast(status as varchar)              as status,
    cast(transaction_ts as timestamp)    as transaction_ts,
    cast(transaction_date as date)       as transaction_date
from source
  );

[0m12:28:50.411471 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:28:50.418801 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.419174 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m12:28:50.420022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:28:50.422540 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.422983 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */
alter view "medallion"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m12:28:50.424257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:28:50.436049 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:28:50.436562 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.436928 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: COMMIT
[0m12:28:50.445114 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:28:50.451780 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m12:28:50.452225 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

      drop view if exists "medallion"."main"."stg_transactions__dbt_backup" cascade
    
[0m12:28:50.458885 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:28:50.461962 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m12:28:50.464034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2595c1520>]}
[0m12:28:50.464905 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.11s]
[0m12:28:50.465645 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m12:28:50.467664 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m12:28:50.468322 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_customer_transactions .................... [RUN]
[0m12:28:50.469007 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.medallion_dbt.fct_customer_transactions'
[0m12:28:50.469505 [debug] [Thread-3 (]: Began compiling node model.medallion_dbt.fct_customer_transactions
[0m12:28:50.473787 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.474714 [debug] [Thread-3 (]: Began executing node model.medallion_dbt.fct_customer_transactions
[0m12:28:50.498140 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.499839 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.500296 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: BEGIN
[0m12:28:50.500665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:28:50.502497 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:28:50.502982 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.503409 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

  
    
    

    create  table
      "medallion"."main"."fct_customer_transactions__dbt_tmp"
  
    as (
      -- depends_on: "medallion"."main"."stg_transactions"

with base as (
    select *
    from "medallion"."main"."stg_transactions"
),

agg as (
    select
        customer_id,
        count(*) as transaction_count,
        sum(case when status = 'completed' then amount else 0 end) as total_amount_completed,
        sum(amount) as total_amount_all
    from base
    group by customer_id
)

select *
from agg
    );
  
  
[0m12:28:50.510634 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:28:50.519240 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.520066 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m12:28:50.522652 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:28:50.524761 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.525208 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_customer_transactions'
  
[0m12:28:50.527082 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:28:50.531454 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.531946 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions" rename to "fct_customer_transactions__dbt_backup"
[0m12:28:50.533110 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:28:50.536355 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.536913 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */
alter table "medallion"."main"."fct_customer_transactions__dbt_tmp" rename to "fct_customer_transactions"
[0m12:28:50.537682 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:28:50.542253 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:28:50.542731 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.543173 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: COMMIT
[0m12:28:50.549921 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:28:50.553570 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_dbt.fct_customer_transactions"
[0m12:28:50.554000 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.fct_customer_transactions"} */

      drop table if exists "medallion"."main"."fct_customer_transactions__dbt_backup" cascade
    
[0m12:28:50.561250 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:28:50.564076 [debug] [Thread-3 (]: On model.medallion_dbt.fct_customer_transactions: Close
[0m12:28:50.564956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87f363c-34de-4ad7-95cd-6cad5c75a12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d25946ee70>]}
[0m12:28:50.565816 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_customer_transactions ............... [[32mOK[0m in 0.10s]
[0m12:28:50.566546 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m12:28:50.570533 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:50.571153 [debug] [MainThread]: On master: BEGIN
[0m12:28:50.571560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:50.573088 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:28:50.573600 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.574201 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:50.574671 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.576127 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:28:50.576637 [debug] [MainThread]: On master: Close
[0m12:28:50.577257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:50.577576 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m12:28:50.577941 [debug] [MainThread]: Connection 'model.medallion_dbt.fct_customer_transactions' was properly closed.
[0m12:28:50.578410 [info ] [MainThread]: 
[0m12:28:50.578989 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:28:50.580070 [debug] [MainThread]: Command end result
[0m12:28:50.618587 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:28:50.622852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:28:50.631136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:28:50.631797 [info ] [MainThread]: 
[0m12:28:50.632444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:50.632844 [info ] [MainThread]: 
[0m12:28:50.633311 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:28:50.634028 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:28:50.635599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8164953, "process_in_blocks": "256", "process_kernel_time": 0.523065, "process_mem_max_rss": "159932", "process_out_blocks": "3144", "process_user_time": 2.920135}
[0m12:28:50.636232 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:50.636096 after 1.82 seconds
[0m12:28:50.636733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26c085a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26c8598b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d26c858080>]}
[0m12:28:50.637188 [debug] [MainThread]: Flushing usage events
[0m12:28:51.452724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:54.880302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd66655ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6662c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd66871fb30>]}


============================== 12:28:54.884225 | d1f1a944-8a04-4562-b4d6-0016badb8050 ==============================
[0m12:28:54.884225 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:28:54.884888 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/logs', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/profiles', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --project-dir /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False'}
[0m12:28:55.141605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd659e63890>]}
[0m12:28:55.207938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd665a0f0e0>]}
[0m12:28:55.210239 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m12:28:55.332999 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:28:55.446230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:55.447142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:55.490300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd659d40c20>]}
[0m12:28:55.567023 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:28:55.570885 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:28:55.601827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6239005f0>]}
[0m12:28:55.602553 [info ] [MainThread]: Found 2 models, 16 data tests, 444 macros
[0m12:28:55.603010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd659d42d50>]}
[0m12:28:55.605390 [info ] [MainThread]: 
[0m12:28:55.605892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:55.606331 [info ] [MainThread]: 
[0m12:28:55.607307 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:28:55.613842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m12:28:55.668540 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:28:55.669439 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m12:28:55.669893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:55.698753 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m12:28:55.700012 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m12:28:55.700485 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m12:28:55.716733 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:28:55.719709 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m12:28:55.721365 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m12:28:55.721738 [debug] [ThreadPool]: On list_medallion_main: Close
[0m12:28:55.723631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1a944-8a04-4562-b4d6-0016badb8050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6682ffaa0>]}
[0m12:28:55.724342 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:55.724682 [debug] [MainThread]: On master: BEGIN
[0m12:28:55.725006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:55.726542 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:28:55.726962 [debug] [MainThread]: On master: COMMIT
[0m12:28:55.727608 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:55.728046 [debug] [MainThread]: On master: COMMIT
[0m12:28:55.729031 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:28:55.729642 [debug] [MainThread]: On master: Close
[0m12:28:55.736341 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:28:55.737020 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:28:55.737794 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:28:55.738789 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:28:55.738351 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m12:28:55.739577 [info ] [Thread-2 (]: 2 of 16 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m12:28:55.740169 [info ] [Thread-3 (]: 3 of 16 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m12:28:55.740770 [info ] [Thread-4 (]: 4 of 16 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m12:28:55.741746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m12:28:55.742443 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:28:55.743118 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:28:55.743746 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:28:55.744388 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:28:55.745140 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:28:55.745936 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:28:55.746507 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:28:55.777529 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:28:55.779285 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:28:55.785327 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:28:55.789800 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:28:55.791870 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:28:55.792588 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:28:55.792988 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:28:55.799231 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:28:55.826553 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:28:55.827716 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:28:55.830149 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:28:55.832535 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:28:55.834677 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:28:55.835232 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:28:55.835728 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m12:28:55.836223 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:28:55.836860 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m12:28:55.837410 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:28:55.837906 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:28:55.838419 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m12:28:55.839147 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:28:55.839780 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m12:28:55.841384 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:28:55.842644 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:28:55.843298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:55.843863 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:28:55.844638 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m12:28:55.845614 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:28:55.846255 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m12:28:55.846887 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:28:55.847447 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m12:28:55.847968 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m12:28:55.848538 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m12:28:55.849093 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m12:28:55.850193 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m12:28:55.851265 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m12:28:55.852618 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:28:55.853271 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:28:55.853774 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:28:55.860338 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:28:55.861992 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m12:28:55.863858 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m12:28:55.866637 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m12:28:55.868313 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m12:28:55.869517 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m12:28:55.871217 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m12:28:55.872574 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m12:28:55.873964 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m12:28:55.874857 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m12:28:55.876638 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m12:28:55.877336 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m12:28:55.877957 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m12:28:55.879272 [info ] [Thread-4 (]: 4 of 16 PASS non_negative_fct_customer_transactions_transaction_count .......... [[32mPASS[0m in 0.14s]
[0m12:28:55.880348 [info ] [Thread-2 (]: 2 of 16 PASS non_negative_fct_customer_transactions_total_amount_all ........... [[32mPASS[0m in 0.14s]
[0m12:28:55.881466 [info ] [Thread-3 (]: 3 of 16 PASS non_negative_fct_customer_transactions_total_amount_completed ..... [[32mPASS[0m in 0.14s]
[0m12:28:55.882453 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_transactions_status__completed__pending__failed  [[32mPASS[0m in 0.14s]
[0m12:28:55.883603 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m12:28:55.884471 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m12:28:55.885314 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m12:28:55.885952 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m12:28:55.886692 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:28:55.887692 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:28:55.888666 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:28:55.889365 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:28:55.889991 [info ] [Thread-4 (]: 5 of 16 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m12:28:55.891167 [info ] [Thread-2 (]: 6 of 16 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m12:28:55.892120 [info ] [Thread-3 (]: 7 of 16 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m12:28:55.892792 [info ] [Thread-1 (]: 8 of 16 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m12:28:55.893977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m12:28:55.894764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m12:28:55.895518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m12:28:55.896103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m12:28:55.896683 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:28:55.897542 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:28:55.898128 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:28:55.898729 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:28:55.904578 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:28:55.916176 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:28:55.921086 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:28:55.925164 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:28:55.926918 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:28:55.927556 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:28:55.932194 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:28:55.933110 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:28:55.935716 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:28:55.936335 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:28:55.938507 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:28:55.939690 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:28:55.942217 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:28:55.943022 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:28:55.943549 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m12:28:55.944120 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:28:55.944849 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m12:28:55.945582 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:28:55.946252 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m12:28:55.946811 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:28:55.947548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:28:55.948793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:28:55.949410 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m12:28:55.950029 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:28:55.951410 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:28:55.951856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:55.952249 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:28:55.952709 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m12:28:55.953158 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m12:28:55.953963 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m12:28:55.954597 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:28:55.955616 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m12:28:55.956389 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m12:28:55.956869 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:28:55.957400 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m12:28:55.958993 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m12:28:55.960024 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:28:55.960599 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:28:55.961068 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:28:55.961626 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:28:55.964146 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m12:28:55.966527 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m12:28:55.968399 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m12:28:55.970267 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m12:28:55.971742 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m12:28:55.972996 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m12:28:55.973943 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m12:28:55.974797 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m12:28:55.975351 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m12:28:55.975958 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m12:28:55.976503 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m12:28:55.977032 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m12:28:55.978082 [info ] [Thread-3 (]: 7 of 16 PASS not_null_fct_customer_transactions_total_amount_all ............... [[32mPASS[0m in 0.08s]
[0m12:28:55.979171 [info ] [Thread-2 (]: 6 of 16 PASS not_null_fct_customer_transactions_customer_id .................... [[32mPASS[0m in 0.08s]
[0m12:28:55.980039 [info ] [Thread-4 (]: 5 of 16 PASS non_negative_stg_transactions_amount .............................. [[32mPASS[0m in 0.09s]
[0m12:28:55.981512 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m12:28:55.980949 [info ] [Thread-1 (]: 8 of 16 PASS not_null_fct_customer_transactions_total_amount_completed ......... [[32mPASS[0m in 0.08s]
[0m12:28:55.982395 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m12:28:55.983253 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m12:28:55.983992 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:28:55.984915 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m12:28:55.985562 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:28:55.986446 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:28:55.987439 [info ] [Thread-3 (]: 9 of 16 START test not_null_fct_customer_transactions_transaction_count ........ [RUN]
[0m12:28:55.988096 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:28:55.988658 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_transactions_amount ........................... [RUN]
[0m12:28:55.989215 [info ] [Thread-4 (]: 11 of 16 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m12:28:55.990150 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m12:28:55.990983 [info ] [Thread-1 (]: 12 of 16 START test not_null_stg_transactions_status ........................... [RUN]
[0m12:28:55.991713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m12:28:55.992271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m12:28:55.992839 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:28:55.993487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m12:28:55.994082 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:28:55.994541 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:28:56.001623 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:28:56.002967 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:28:56.007679 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:28:56.012354 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:28:56.017983 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:28:56.019276 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:28:56.020941 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:28:56.024784 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:28:56.025658 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:28:56.026177 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:28:56.030008 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:28:56.172108 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:28:56.175153 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:28:56.175902 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:28:56.177319 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m12:28:56.178193 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:28:56.178719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:28:56.179469 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m12:28:56.180114 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:28:56.181944 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:28:56.183121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:28:56.183767 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m12:28:56.184211 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m12:28:56.184801 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m12:28:56.185788 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m12:28:56.186298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:56.186679 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:28:56.187257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:28:56.187734 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.188610 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m12:28:56.189241 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:28:56.190276 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:28:56.190781 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.191398 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m12:28:56.191833 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:28:56.192346 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m12:28:56.193383 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.196407 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m12:28:56.197104 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.197935 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:28:56.199990 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m12:28:56.203510 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m12:28:56.204286 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:28:56.204975 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m12:28:56.205503 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:28:56.206621 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m12:28:56.208926 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m12:28:56.210060 [info ] [Thread-3 (]: 9 of 16 PASS not_null_fct_customer_transactions_transaction_count .............. [[32mPASS[0m in 0.22s]
[0m12:28:56.211846 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m12:28:56.212314 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m12:28:56.213527 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m12:28:56.214242 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m12:28:56.215216 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m12:28:56.216016 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_transactions_amount ................................. [[32mPASS[0m in 0.22s]
[0m12:28:56.216567 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m12:28:56.217294 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:28:56.218059 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m12:28:56.218865 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m12:28:56.219560 [info ] [Thread-3 (]: 13 of 16 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m12:28:56.220273 [info ] [Thread-4 (]: 11 of 16 PASS not_null_stg_transactions_customer_id ............................ [[32mPASS[0m in 0.23s]
[0m12:28:56.221800 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stg_transactions_status ................................. [[32mPASS[0m in 0.23s]
[0m12:28:56.222433 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:28:56.223369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m12:28:56.224081 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m12:28:56.224679 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m12:28:56.225157 [info ] [Thread-2 (]: 14 of 16 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m12:28:56.225724 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:28:56.226403 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:28:56.227101 [debug] [Thread-1 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:28:56.227711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m12:28:56.233995 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:28:56.234755 [info ] [Thread-4 (]: 15 of 16 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m12:28:56.235589 [info ] [Thread-1 (]: 16 of 16 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m12:28:56.236258 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:28:56.237441 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m12:28:56.238251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m12:28:56.238990 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:28:56.245392 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:28:56.246259 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:28:56.246804 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:28:56.250010 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:28:56.255072 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:28:56.264245 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:28:56.265365 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:28:56.266906 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:28:56.267838 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:28:56.271126 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:28:56.271704 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:28:56.274445 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:28:56.275266 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m12:28:56.278083 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:28:56.279547 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:28:56.280116 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:28:56.280574 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:28:56.281508 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m12:28:56.283073 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:28:56.283591 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m12:28:56.284256 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:28:56.284696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:28:56.285335 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m12:28:56.286031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:28:56.286656 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m12:28:56.287877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:56.288654 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:28:56.289216 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.289666 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:28:56.290530 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m12:28:56.291257 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:28:56.292256 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m12:28:56.292884 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.293442 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m12:28:56.294107 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m12:28:56.295103 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:28:56.296134 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:28:56.299558 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m12:28:56.301385 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:28:56.303050 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m12:28:56.303789 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:28:56.306482 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m12:28:56.307070 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m12:28:56.307845 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:28:56.310360 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m12:28:56.311624 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m12:28:56.312615 [info ] [Thread-3 (]: 13 of 16 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.09s]
[0m12:28:56.314409 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m12:28:56.316251 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m12:28:56.316749 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m12:28:56.317587 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m12:28:56.318107 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m12:28:56.319196 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m12:28:56.320086 [info ] [Thread-2 (]: 14 of 16 PASS not_null_stg_transactions_transaction_id ......................... [[32mPASS[0m in 0.09s]
[0m12:28:56.321520 [debug] [Thread-1 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m12:28:56.321165 [info ] [Thread-4 (]: 15 of 16 PASS not_null_stg_transactions_transaction_ts ......................... [[32mPASS[0m in 0.08s]
[0m12:28:56.322343 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m12:28:56.323191 [info ] [Thread-1 (]: 16 of 16 PASS unique_stg_transactions_transaction_id ........................... [[32mPASS[0m in 0.08s]
[0m12:28:56.324100 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m12:28:56.325015 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m12:28:56.329578 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:56.330394 [debug] [MainThread]: On master: BEGIN
[0m12:28:56.330782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:56.332375 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:28:56.332750 [debug] [MainThread]: On master: COMMIT
[0m12:28:56.333092 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:56.333401 [debug] [MainThread]: On master: COMMIT
[0m12:28:56.334192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:28:56.334718 [debug] [MainThread]: On master: Close
[0m12:28:56.335571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:56.335955 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m12:28:56.336256 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m12:28:56.336543 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m12:28:56.336824 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m12:28:56.337256 [info ] [MainThread]: 
[0m12:28:56.337708 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:28:56.340234 [debug] [MainThread]: Command end result
[0m12:28:56.378246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/manifest.json
[0m12:28:56.381208 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/semantic_manifest.json
[0m12:28:56.390393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/marco/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/examen_ing_de_sw_n_data_final_PADILLA_VIDAL/dbt/target/run_results.json
[0m12:28:56.391114 [info ] [MainThread]: 
[0m12:28:56.391788 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:56.392307 [info ] [MainThread]: 
[0m12:28:56.392799 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m12:28:56.394422 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.5747771, "process_in_blocks": "704", "process_kernel_time": 0.526062, "process_mem_max_rss": "158388", "process_out_blocks": "2448", "process_user_time": 2.634043}
[0m12:28:56.395224 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:56.395101 after 1.58 seconds
[0m12:28:56.395823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd666633740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6666326f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6660fb8c0>]}
[0m12:28:56.396312 [debug] [MainThread]: Flushing usage events
[0m12:28:57.163161 [debug] [MainThread]: An error was encountered while trying to flush usage events
